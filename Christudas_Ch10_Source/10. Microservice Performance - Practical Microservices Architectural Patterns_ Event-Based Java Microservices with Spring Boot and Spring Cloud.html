<!DOCTYPE html>
<!-- saved from url=(0127)https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml -->
<html class=" js flexbox flexboxlegacy no-touch websqldatabase indexeddb history csscolumns csstransforms localstorage sessionstorage applicationcache svg inlinesvg zoom" lang="en" prefix="og: http://ogp.me/ns/# og:book: http://ogp.me/ns/book# og:video: http://ogp.me/ns/video#" itemscope="" itemtype="http://schema.org/Book http://schema.org/ItemPage" data-login-url="/accounts/login/" data-offline-url="/" data-url="/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_11_Chapter.xhtml" data-csrf-cookie="csrfsafari" data-highlight-privacy="private" data-user-id="4423847" data-user-uuid="6d9ee17b-34b1-4bf4-bdae-19676bd84ca1" data-username="fwang3" data-account-type="B2B" data-activated-trial-date="" data-archive="9781484245019" data-publishers="Apress" data-htmlfile-name="477630_1_En_11_Chapter.xhtml" data-epub-title="Practical Microservices Architectural Patterns: Event-Based Java Microservices with Spring Boot and Spring Cloud" data-debug="0" data-testing="0" style=""><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="author" content="O&#39;Reilly Media"><meta name="format-detection" content="telephone=no"><meta http-equiv="cleartype" content="on"><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta name="apple-itunes-app" content="app-id=881697395, app-argument=safaridetail://9781484245019"><link rel="shortcut icon" href="https://www.oreilly.com/favicon.ico"><meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, maximum-scale=1.0"><meta property="twitter:account_id" content="4503599627559754"><link rel="shortcut icon" href="https://learning.oreilly.com/favicon.ico" type="image/x-icon"><link href="./10. Microservice Performance - Practical Microservices Architectural Patterns_ Event-Based Java Microservices with Spring Boot and Spring Cloud_files/css" rel="stylesheet" type="text/css"><title>10.&nbsp;Microservice Performance - Practical Microservices Architectural Patterns: Event-Based Java Microservices with Spring Boot and Spring Cloud</title><link rel="stylesheet" href="./10. Microservice Performance - Practical Microservices Architectural Patterns_ Event-Based Java Microservices with Spring Boot and Spring Cloud_files/output.731fc84c4.css" type="text/css"><link rel="stylesheet" type="text/css" href="./10. Microservice Performance - Practical Microservices Architectural Patterns_ Event-Based Java Microservices with Spring Boot and Spring Cloud_files/annotator.e3b0c4.css"><link rel="stylesheet" href="./10. Microservice Performance - Practical Microservices Architectural Patterns_ Event-Based Java Microservices with Spring Boot and Spring Cloud_files/font-awesome.min.css"><style type="text/css" title="ibis-book">#sbo-rt-content a{text-decoration:none}#sbo-rt-content a:link,#sbo-rt-content a:active{color:#0176C3}#sbo-rt-content a:visited{color:#5f5f5f}#sbo-rt-content div{font-family:"Cambria","Minion Pro","Times New Roman","Times",serif;}#sbo-rt-content img{border:0;vertical-align:middle}#sbo-rt-content video{display:block;margin-top:1em;max-width:100%;text-indent:0;width:100%}#sbo-rt-content p{margin:0}#sbo-rt-content .Heading,#sbo-rt-content .SubHeading,#sbo-rt-content .ContextInformation,#sbo-rt-content .MainTitleSection,#sbo-rt-content .PartTitle,#sbo-rt-content .SeriesTitle,#sbo-rt-content .SeriesSubTitle,#sbo-rt-content .SubSeriesTitle,#sbo-rt-content .SubSeriesSubTitle,#sbo-rt-content .BookTitle,#sbo-rt-content .BookSubTitle,#sbo-rt-content .ForewordTitle,#sbo-rt-content .PrefaceTitle,#sbo-rt-content .BookAcknowledgmentsTitle,#sbo-rt-content .BookNotesTitle{text-align:left !important}#sbo-rt-content .Heading,#sbo-rt-content .SubHeading{display:block;font-weight:bold}#sbo-rt-content .ArticleContextInformation{border-bottom:1px solid;margin-bottom:.8em;padding-bottom:.3em}#sbo-rt-content .ArticleContextInformation .ContextInformation{display:block;font-size:80%}#sbo-rt-content .ArticleContextInformation .JournalTitle:after,#sbo-rt-content .ArticleContextInformation .JournalSubTitle:after{content:", "}#sbo-rt-content .ArticleCopyright{display:inline}#sbo-rt-content .ArticleCopyright .CopyrightComment,#sbo-rt-content .ArticleContextInformation .ArticleDOI{display:block}#sbo-rt-content .ChapterContextInformation{border-bottom:1px solid;margin-bottom:.8em;padding-bottom:.3em}#sbo-rt-content .ChapterContextInformation .ContextInformation{display:block;font-size:80%}#sbo-rt-content .ChapterCopyright .CopyrightComment{display:block}#sbo-rt-content .ChapterContextInformation .BookEdition:before{content:", "}#sbo-rt-content .ChapterContextInformation .ContextInformationAuthorEditorNames:after{content:", "}#sbo-rt-content .ChapterContextInformation .BookTitle{font-style:italic}#sbo-rt-content .ChapterContextInformation .SeriesTitle:before{content:", "}#sbo-rt-content .ChapterContextInformation .SeriesSubTitle:before{content:": "}#sbo-rt-content .ChapterContextInformation .ContextInformationVolumeNumber:before{content:" "}#sbo-rt-content .ChapterContextInformation .ChapterDOI{display:block}#sbo-rt-content .Categories{color:#666;margin-bottom:1em;margin-top:1em}#sbo-rt-content .ArticleCategory,#sbo-rt-content .ChapterCategory{font-size:1.2rem}#sbo-rt-content .ArticleSubCategory,#sbo-rt-content .ChapterSubCategory{font-size:1rem}#sbo-rt-content .MainTitleSection{font-weight:bold;margin-bottom:1.2em;margin-top:1.2em}#sbo-rt-content .ArticleSuperTitle{font-size:1.2rem}#sbo-rt-content .MainTitleSection .ArticleTitle,#sbo-rt-content .ForeignLanguageHeader .ArticleTitle,#sbo-rt-content .MainTitleSection .ChapterTitle,#sbo-rt-content .ForeignLanguageHeader .ChapterTitle{font-size:1.73rem;margin:0}#sbo-rt-content .ArticleSubTitle,#sbo-rt-content .ChapterSubTitle{font-size:1.2rem;padding-top:.2em}#sbo-rt-content div>.AuthorGroup .AuthorNames,#sbo-rt-content .BookBackmatter>.AuthorGroup .AuthorNames{font-size:100%;margin-bottom:1em;margin-top:1em;text-align:left !important}#sbo-rt-content .BookBackmatter>.AuthorGroup .AuthorNames{font-weight:bold}#sbo-rt-content .AuthorNames sup{font-size:70%}#sbo-rt-content .Prefix:after{content:" "}#sbo-rt-content .Suffix:before{content:" "}#sbo-rt-content .Degrees:before{content:", "}#sbo-rt-content .NativeName:before,#sbo-rt-content .Role:before{content:" ("}#sbo-rt-content .NativeName:after,#sbo-rt-content .Role:after{content:")"}#sbo-rt-content .AffiliationNumber{float:left;padding-right:.5em}#sbo-rt-content .AffiliationText{margin-left:2em}#sbo-rt-content .AffiliationHint{font-style:italic}#sbo-rt-content .AuthorNames .DeceasedSymbol:before{content:"†";padding-left:3px}#sbo-rt-content .AuthorNames .EqualContributionSymbol:before{content:"*";padding-left:3px}#sbo-rt-content .InstitutionMembers:before{content:" ("}#sbo-rt-content .InstitutionMembers:after{content:")"}#sbo-rt-content .AffiliationLegend .DeceasedSymbol:before{content:"†";display:inline-block;width:14px}#sbo-rt-content .AffiliationLegend .EqualContributionSymbol:before{content:"*";display:inline-block;width:14px}#sbo-rt-content .ClearBoth{clear:both;font-size:0;line-height:0 !important}#sbo-rt-content .Contact,#sbo-rt-content .AffiliationLegend{margin-bottom:1em;margin-top:1em}#sbo-rt-content .ContactIcon{background-image:url(envelope.png);background-repeat:no-repeat;background-size:contain;width:.8rem}#sbo-rt-content .AuthorNames .ContactIcon{display:inline-block}#sbo-rt-content .Contact .ContactIcon{float:left;margin-top:4px;margin-right:4px}#sbo-rt-content .ContactAuthorLine{padding-left:20px;font-weight:bold}#sbo-rt-content .ContactAdditionalLine{padding-left:20px}#sbo-rt-content .ContactType{font-weight:bold}#sbo-rt-content .ArticleHistory{margin-bottom:1em;margin-top:1em}#sbo-rt-content .HistoryLabel{font-weight:bold}#sbo-rt-content .History+.History{padding-left:.5em}#sbo-rt-content .ArticleOrChapterToc{border-top:1px solid #bbb;margin-top:1em;padding-top:1em}#sbo-rt-content .ArticleOrChapterToc .HeadingNumber{font-weight:bold;padding-right:.3em}#sbo-rt-content .Abstract{margin-top:1em}#sbo-rt-content .Abstract>.Heading{font-size:1em;margin:0}#sbo-rt-content .AbstractSection{margin-top:.3em}#sbo-rt-content .Heading+.AbstractSection{margin-top:0}#sbo-rt-content .AbstractSection>.Heading{font-size:1em;font-style:italic;font-weight:normal;margin:0}#sbo-rt-content .KeywordGroup{margin-top:1em}#sbo-rt-content .KeywordGroup .Heading{display:inline;font-size:1em;margin:0;padding-right:.5em}#sbo-rt-content .Keyword+.Keyword:before{content:" – "}#sbo-rt-content .ArticleExternalID{margin-top:1em}#sbo-rt-content .ArticleExternalIDLabel{font-weight:bold}#sbo-rt-content .ForeignLanguageHeader{border-top:1px solid #bbb;margin-top:1em}#sbo-rt-content .ForeignLanguageTitleSection{font-weight:bold;margin-bottom:1.2em;margin-top:1rem}#sbo-rt-content .AbbreviationGroup{margin-top:1em}#sbo-rt-content .ForeignLanguageHeader+.AbbreviationGroup{border-top:1px solid #bbb;margin-top:1em;padding-top:1em}#sbo-rt-content .AbbreviationGroup>.Heading{font-size:1em;margin:0}#sbo-rt-content .AbbreviationGroup .DefinitionList{margin-top:0;margin-bottom:0;padding-right:.1em;padding-top:.1em;padding-bottom:.1em}#sbo-rt-content .AbbreviationGroupSection>.Heading{font-size:1em;margin:0;padding-top:.2em}#sbo-rt-content .ArticleNote{margin-top:1em}#sbo-rt-content .ArticleNote>.Heading{font-size:1em;margin:0}#sbo-rt-content .ArticleNoteMotto{font-style:italic;margin-left:1.5em;margin-right:1.5em;text-align:right}#sbo-rt-content .Biography{display:block;margin-top:.8em;padding-bottom:0;width:100%}#sbo-rt-content .Loc .AuthorGroup .Biography{margin-top:0}#sbo-rt-content .Biography .FormalPara,#sbo-rt-content .Biography .BiographyFigure{display:block;margin-top:0;margin-bottom:0}#sbo-rt-content .Biography .BiographyFigure{float:right;margin-left:6px}#sbo-rt-content .Biography .Figure{border-bottom:none;margin-top:.5em;margin-bottom:0}#sbo-rt-content .Fulltext>.Para:first-of-type>.BlockQuote:first-child{margin-top:0}#sbo-rt-content .BlockQuote{margin:1em 1.5em}#sbo-rt-content .BlockQuote>.Heading{font-size:1em;margin-top:1em;margin-bottom:0;text-indent:0}#sbo-rt-content .BlockQuote>.Para{text-indent:0}#sbo-rt-content .Heading+.Para>.BlockQuote:first-child{margin-top:0}#sbo-rt-content .Caption,#sbo-rt-content .TableFooter{display:block;text-align:left}#sbo-rt-content .TableFooter .SimplePara+.SimplePara{text-indent:0}#sbo-rt-content .Caption{margin-top:.5em}#sbo-rt-content .CaptionContent{font-size:90%}#sbo-rt-content .TableFooter{margin-top:1em}#sbo-rt-content .Table .Caption{margin-top:.5em}#sbo-rt-content .Figure .Caption,#sbo-rt-content video+.Caption{margin-bottom:1em}#sbo-rt-content .Table .Caption{margin-bottom:.5em}#sbo-rt-content .CaptionNumber{font-style:italic;font-weight:bold;padding-right:.6em}#sbo-rt-content .CaptionContent>span.Heading{display:inline}#sbo-rt-content .CaptionContent>span.SimplePara{display:block}#sbo-rt-content .CaptionContent>.SimplePara:first-child,#sbo-rt-content .CaptionContent>.CaptionNumber+.SimplePara,#sbo-rt-content .CaptionContent>a+.SimplePara{display:inline;margin-top:0}#sbo-rt-content .Credit>.SimplePara{text-indent:1.5em}#sbo-rt-content .DefinitionList{margin-top:1em;margin-bottom:1em;padding:.1em}#sbo-rt-content .DefinitionList>.Heading{font-size:1rem;margin:0;text-indent:0}#sbo-rt-content dl{margin:0}#sbo-rt-content .DefinitionList:after{content:"";clear:both;display:table}#sbo-rt-content .Term{clear:both;float:left;font-style:italic;padding-right:1em;text-indent:0;vertical-align:top}#sbo-rt-content .Description{padding-bottom:.3em;margin-left:0}#sbo-rt-content .Description .Para:first-child{text-indent:0}#sbo-rt-content .Heading+.Para>div.DefinitionList:first-child{margin-top:0}#sbo-rt-content .EmphasisTypeBold{font-weight:bold}#sbo-rt-content .EmphasisTypeItalic{font-style:italic}#sbo-rt-content .EmphasisTypeUnderline{text-decoration:underline}#sbo-rt-content .EmphasisTypeDoubleUnderline{border-bottom-style:double}#sbo-rt-content .EmphasisTypeSmallCaps{font-variant:small-caps}#sbo-rt-content .EmphasisTypeBoldItalic{font-weight:bold;font-style:italic}#sbo-rt-content .EmphasisTypeBoldUnderline{font-weight:bold;text-decoration:underline}#sbo-rt-content .EmphasisTypeBoldDoubleUnderline{font-weight:bold;border-bottom-style:double}#sbo-rt-content .EmphasisTypeBoldSmallCaps{font-weight:bold;font-variant:small-caps}#sbo-rt-content .EmphasisTypeItalicUnderline{font-style:italic;text-decoration:underline}#sbo-rt-content .EmphasisTypeItalicDoubleUnderline{font-style:italic;border-bottom-style:double}#sbo-rt-content .EmphasisTypeItalicSmallCaps{font-style:italic;font-variant:small-caps}#sbo-rt-content .EmphasisTypeBoldItalicUnderline{font-weight:bold;font-style:italic;text-decoration:underline}#sbo-rt-content .EmphasisTypeBoldItalicDoubleUnderline{font-weight:bold;font-style:italic;border-bottom-style:double}#sbo-rt-content .EmphasisTypeBoldItalicSmallCaps{font-weight:bold;font-style:italic;font-variant:small-caps}#sbo-rt-content .EmphasisTypeUnderlineSmallCaps{text-decoration:underline;font-variant:small-caps}#sbo-rt-content .EmphasisTypeDoubleUnderlineSmallCaps{border-bottom-style:double;font-variant:small-caps}#sbo-rt-content .EmphasisFontCategoryNonProportional{font-family:"Courier New",Courier,monospace}#sbo-rt-content :not(.ParaTypeProgramcode)>.EmphasisFontCategoryNonProportional{font-size:95%}#sbo-rt-content .EmphasisFontCategorySansSerif{font-family:"Arial","Helvetica",sans-serif;font-size:75%}#sbo-rt-content .EmphasisTypeStrikethrough{text-decoration:line-through}#sbo-rt-content .Equation{display:block;text-indent:0;vertical-align:middle}#sbo-rt-content .NumberedEquation{display:table;width:100%}#sbo-rt-content .NumberedEquation .EquationWrapper{display:table-row}#sbo-rt-content .NumberedEquation .EquationContent{display:table-cell}#sbo-rt-content .EquationContent{margin-top:.5em;margin-bottom:0;width:100%;text-align:center;text-indent:0;vertical-align:middle}#sbo-rt-content .EquationContent div{margin-top:.5em}#sbo-rt-content .EquationContent .MediaObject{margin-left:auto;margin-right:auto}#sbo-rt-content .EquationContent img{background:white;max-width:100%}#sbo-rt-content .EquationNumber{display:table-cell;margin-bottom:.4em;text-align:right;vertical-align:middle;white-space:nowrap}#sbo-rt-content .EquationSourceXml{white-space:nowrap}#sbo-rt-content .InlineEquation img{background:white;vertical-align:text-top}#sbo-rt-content .Figure{margin-top:1em;margin-bottom:1em;margin-left:0;margin-right:0;text-align:center;text-indent:0}#sbo-rt-content .Figure img{height:auto;margin:0;max-width:100%;padding:2px}#sbo-rt-content .MediaObject{display:block;text-align:center}#sbo-rt-content .MediaObject:last-child{margin-bottom:1em}#sbo-rt-content .EquationContent>.MediaObject:last-child{margin-bottom:0}#sbo-rt-content .MediaObject+.MediaObject{margin-top:1em}#sbo-rt-content .FootnoteSection{border-top:1px solid #bbb;margin-top:1em}#sbo-rt-content .FootnoteSection>.Heading{font-size:1.44rem;margin-top:.8em;margin-bottom:.1em}#sbo-rt-content .Footnote{clear:both;font-size:90%;text-align:left}#sbo-rt-content .FootnoteNumber{float:left;padding-right:.5em}#sbo-rt-content .FootnoteParas>div{margin-left:1em;margin-top:.3em}#sbo-rt-content .FormalPara{margin-top:1em;margin-bottom:1em}#sbo-rt-content .FormalPara .Heading{font-size:1em;margin:0}#sbo-rt-content .FormalParaRenderingStyle1>.Heading{display:inline;padding-right:1em}#sbo-rt-content .FormalParaRenderingStyle2>.Heading{display:inline;font-style:italic;font-weight:normal;padding-right:1em}#sbo-rt-content .FormalParaRenderingStyle3>.Heading{padding-right:1em}#sbo-rt-content .FormalParaRenderingStyle1>p:first-of-type,#sbo-rt-content .FormalParaRenderingStyle2>p:first-of-type{display:inline}#sbo-rt-content .Heading+.FormalPara{margin-top:0}#sbo-rt-content .FormalPara .AuthorNames{font-style:italic;font-weight:normal !important}#sbo-rt-content .HeadingNumber{padding-right:.3em}#sbo-rt-content .RenderAsSection1>.Heading{font-size:1.44rem;margin-top:.5em;margin-bottom:.1em}#sbo-rt-content .RenderAsSection2>.Heading{font-size:1.2rem;margin-top:.8em;margin-bottom:.1em}#sbo-rt-content .Heading+.Section2>.Heading:first-child{margin-top:0}#sbo-rt-content .RenderAsSection3>.Heading{font-size:1.2rem;font-style:italic;margin-top:.8em;margin-bottom:.1em}#sbo-rt-content .Heading+.Section3>.Heading:first-child{margin-top:0}#sbo-rt-content .RenderAsSection4>.Heading{font-size:100%;font-style:italic;margin-top:.8em;margin-bottom:.1em}#sbo-rt-content .Heading+.Section4>.Heading:first-child{margin-top:0}#sbo-rt-content .RenderAsSection5>.Heading{font-size:100%;margin-top:.8em;margin-bottom:.1em}#sbo-rt-content .Heading+.Section5>.Heading:first-child{margin-top:0}#sbo-rt-content .RenderAsSection6>.Heading{font-size:100%;margin-top:.8em;margin-bottom:.1em}#sbo-rt-content .Heading+.Section6>.Heading:first-child{margin-top:0}#sbo-rt-content .RenderAsSection7>.Heading{font-size:100%;margin-top:.8em;margin-bottom:.1em}#sbo-rt-content .Heading+.Section7>.Heading:first-child{margin-top:0}#sbo-rt-content .Literal{font-family:"Courier New",Courier,monospace}#sbo-rt-content .OrderedList{margin-top:.5em;margin-bottom:.5em;text-indent:0;display:table}#sbo-rt-content .OrderedList>ol{margin:0;padding:0}#sbo-rt-content .OrderedList .Heading{font-size:1em;font-style:italic;font-weight:normal;margin-top:0;margin-bottom:0;display:table-caption}#sbo-rt-content .OrderedList .Heading+.ListItem{margin-top:0}#sbo-rt-content .Heading+.Para>div.OrderedList:first-child,#sbo-rt-content .Heading+.Para>div.OrderedList:first-child>.Heading{margin-top:0}#sbo-rt-content .ListItem{margin-top:.5em;display:table-row}#sbo-rt-content .ItemNumber{padding-right:.5em;display:table-cell;vertical-align:top}#sbo-rt-content .ItemContent{display:table-cell}#sbo-rt-content .Fulltext>.Para:first-of-type{border-top:1px solid #bbb;margin-top:1em;padding-top:1em}#sbo-rt-content .Fulltext>.Para~.Para:first-of-type{border-top:none;margin-top:0;padding-top:0}#sbo-rt-content .Para+.Para{margin-top:0;text-indent:1.5em}#sbo-rt-content .ParaTextBreak{margin-top:1em !important;text-indent:0 !important}#sbo-rt-content .ParaTypeExample{border-left:4px solid;padding-left:.5em;margin-top:1em !important;margin-bottom:1em}#sbo-rt-content .ParaTypeEyeCatcher,#sbo-rt-content .ParaTypeTip{border-left:4px solid;padding-left:.5em;margin-top:1em !important;margin-bottom:.5em}#sbo-rt-content .ParaTypeImportant{background:#bbb;border:2px solid;padding:.5em;margin-top:.8em !important;margin-bottom:.8em}#sbo-rt-content .ParaTypeImportant img{background-color:transparent}#sbo-rt-content .ParaTypeGeneticSequence,#sbo-rt-content .ParaTypeLiteral,#sbo-rt-content .ParaTypeProgramcode{font-family:"Courier New",Courier,monospace;font-size:95%}#sbo-rt-content .ParaTypeProgramcode{text-indent:0 !important;word-wrap:break-word}#sbo-rt-content .Para:not(.ParaTypeProgramcode)+.ParaTypeProgramcode{margin-top:.5em}#sbo-rt-content .ParaTypeProgramcode+.Para:not(.ParaTypeProgramcode){margin-top:.5em}#sbo-rt-content .ParaTypeLegalText{font-weight:bold;margin-left:1em;text-align:left}#sbo-rt-content .ParaTypeOverview,#sbo-rt-content .ParaTypeAnswers,#sbo-rt-content .ParaTypeQuestions,#sbo-rt-content .ParaTypeDefinition,#sbo-rt-content .ParaTypeProcedure,#sbo-rt-content .ParaTypeRecipe{border:2px solid;margin-top:.8em !important;margin-bottom:.8em;padding:.5em}#sbo-rt-content .ParaTypeSource{font-style:italic}#sbo-rt-content .ParaTypeTrailer,#sbo-rt-content .ParaTypeLearningGoals{font-weight:bold;padding-left:.5em;padding-right:.5em}#sbo-rt-content .ParaTypeWarning{font-weight:bold}#sbo-rt-content .ParaTypeExample,#sbo-rt-content .ParaTypeEyeCatcher,#sbo-rt-content .ParaTypeImportant,#sbo-rt-content .ParaTypeLegalText,#sbo-rt-content .ParaTypeOverview,#sbo-rt-content .ParaTypeTip,#sbo-rt-content .ParaTypeAnswers,#sbo-rt-content .ParaTypeQuestions,#sbo-rt-content .ParaTypeDefinition,#sbo-rt-content .ParaTypeProcedure,#sbo-rt-content .ParaTypeRecipe{text-indent:0 !important}#sbo-rt-content .Para+.ParaOneEmphasisChild{margin-top:1em;text-indent:0 !important}#sbo-rt-content .ParaOneEmphasisChild+.Para{text-indent:0 !important}#sbo-rt-content .PartNumber{display:block;font-size:1.73rem}#sbo-rt-content .PartTitle{display:block;font-size:1.73rem}#sbo-rt-content .SubPartTitle{display:block;font-size:1.44rem}#sbo-rt-content .ProgramCode{margin-top:1em;margin-bottom:1em}#sbo-rt-content .ProgramCode .FixedLine{font-family:"Courier New",Courier,monospace;font-size:95%;word-wrap:break-word}#sbo-rt-content .LineGroup+.LineGroup{margin-top:1em}#sbo-rt-content .Heading+.Para>.Quiz>.Heading{margin-top:0;}#sbo-rt-content .Quiz .Heading{font-size:1rem;margin-top:1em;margin-bottom:0;text-indent:0}#sbo-rt-content .QuizTask{display:table;margin-top:.5em;margin-bottom:.5em;width:100%;text-indent:0}#sbo-rt-content .QuizTask+.QuizTask{margin-top:1.5em}#sbo-rt-content .QuizItem{padding:.1em}#sbo-rt-content .QuizItemTypeSolution{border:2px solid #aaa;margin-top:.5em;padding:10px}#sbo-rt-content .QuizTask>input{display:none}#sbo-rt-content .QuizItem>label{color:#0176C3}#sbo-rt-content .QuizTask>input~.QuizItem>label+div{display:none}#sbo-rt-content .QuizTask>input:checked~.QuizItem>label+div{display:table-cell}#sbo-rt-content .QuizTask>input~.QuizItem>label:after{content:"  »"}#sbo-rt-content .QuizTask>input:checked~.QuizItem>label:after{content:"  «"}#sbo-rt-content .QuizTask>input~.QuizItemTypeCorrectAnswer{background-color:transparent;transition:background .4s}#sbo-rt-content .QuizTask>input:checked~.QuizItemTypeCorrectAnswer{background-color:#EAF2DB;transition:background .4s}#sbo-rt-content .ReviewTitle{font-weight:bold;margin-top:1em;text-indent:0}#sbo-rt-content .Review .AuthorName+.AuthorName:before{content:", "}#sbo-rt-content .Review .ISBN,#sbo-rt-content .ReviewDataUnstructured{text-indent:0}#sbo-rt-content .Review .Para:first-of-type{margin-top:1em;text-indent:0}#sbo-rt-content .BookBackmatter>.Appendix:first-child>div:first-child{border-top:none !important;margin-top:0 !important;padding-top:0 !important}#sbo-rt-content .BookAcknowledgmentsBody>.RenderAsSection1:first-child,#sbo-rt-content .BookNotesBody>.RenderAsSection1:first-child,#sbo-rt-content .ForewordBody>.RenderAsSection1:first-child,#sbo-rt-content .PrefaceBody>.RenderAsSection1:first-child,#sbo-rt-content .BookBackmatter>.Appendix:first-child>.RenderAsSection1:first-child{border-top:none;margin-top:0}#sbo-rt-content .BookAcknowledgmentsBody>.RenderAsSection1:first-child>.Heading,#sbo-rt-content .ForewordBody>.RenderAsSection1:first-child>.Heading,#sbo-rt-content .PrefaceBody>.RenderAsSection1:first-child>.Heading{margin-top:0}#sbo-rt-content .Section1 .AuthorNames,#sbo-rt-content .Section2 .AuthorNames,#sbo-rt-content .Section3 .AuthorNames{font-weight:bold;margin-top:.3em;margin-bottom:.5em}#sbo-rt-content .Section1 .AuthorNames sup,#sbo-rt-content .Section2 .AuthorNames sup,#sbo-rt-content .Section3 .AuthorNames sup{font-size:70%}#sbo-rt-content .Section1 .Affiliations,#sbo-rt-content .Section2 .Affiliations,#sbo-rt-content .Section3 .Affiliations{margin-bottom:.5em}#sbo-rt-content .SectionTypeBackgroundInformation,#sbo-rt-content .SectionTypeExcurse{font-size:90%}#sbo-rt-content .SectionTypeBox,#sbo-rt-content .SectionTypeOverview,#sbo-rt-content .SectionTypeQuestionnaire{background-color:#BBB;margin-top:1em !important;padding:.5em}#sbo-rt-content .SectionTypeCaseStudy,#sbo-rt-content .SectionTypeExample,#sbo-rt-content .SectionTypeTip{border-left:4px solid;margin-top:1em !important;padding-top:0;padding-left:.5em;padding-right:.5em;padding-bottom:.5em}#sbo-rt-content .SectionTypeTrailer,#sbo-rt-content .SectionTypeLearningGoals{font-weight:bold;text-align:left}#sbo-rt-content .SectionTypeLegalText{font-weight:bold;margin-left:1em;text-align:left;text-indent:0 !important}#sbo-rt-content .SectionTypeProcedure,#sbo-rt-content .SectionTypeRecipe{border:2px solid;margin-top:.8em !important;margin-bottom:.8em;padding:.5em}#sbo-rt-content .SectionTypeWarning{font-weight:bold}#sbo-rt-content .RenderAsSection1{border-top:1px solid #bbb;margin-top:1em}#sbo-rt-content .SectionTypeBox+.RenderAsSection1,#sbo-rt-content .SectionTypeOverview+.RenderAsSection1,#sbo-rt-content .SectionTypeQuestionnaire+.RenderAsSection1{border-top:0;}#sbo-rt-content .SectionTypeBox>.Heading,#sbo-rt-content .SectionTypeOverview>.Heading,#sbo-rt-content .SectionTypeQuestionnaire>.Heading,#sbo-rt-content .SectionTypeProcedure>.Heading,#sbo-rt-content .SectionTypeRecipe>.Heading{margin-top:0}#sbo-rt-content .InternalRefSidebarLexicon{background-image:url(sidebar.gif);background-repeat:no-repeat;font-weight:bold;padding-left:20px}#sbo-rt-content .SidebarDialog{border:1px solid;margin-left:1.5em;margin-top:.4em;margin-bottom:.2em;padding:.2em;text-indent:0}#sbo-rt-content .SidebarNumber{font-weight:bold;padding-right:.5em}#sbo-rt-content .SimplePara+.SimplePara{margin-top:0;text-indent:1.5em}#sbo-rt-content .Stack{display:inline-table;vertical-align:top}#sbo-rt-content .Stack sub{display:table-row}#sbo-rt-content .Stack sup{display:table-header-group}#sbo-rt-content table{border-collapse:collapse;font-size:80%;max-width:100%;text-indent:0}#sbo-rt-content table .SimplePara+.SimplePara{text-indent:0}#sbo-rt-content table,#sbo-rt-content tr,#sbo-rt-content td{border-color:#bbb !important}#sbo-rt-content th{border-color:#999 !important}#sbo-rt-content thead{background:#bbb;color:#000 !important}#sbo-rt-content .Table{margin-bottom:1em;text-indent:0}#sbo-rt-content .Caption .Table{margin-bottom:0}#sbo-rt-content .Table img{height:auto;margin:0;max-width:100%}#sbo-rt-content th div{text-align:left}#sbo-rt-content td div,#sbo-rt-content td p,#sbo-rt-content th div,#sbo-rt-content th p{padding:.2em}#sbo-rt-content .Para+.Table,#sbo-rt-content .Para>.Table{margin-top:1em}#sbo-rt-content .SimplePara>.Table{margin-top:.5em}#sbo-rt-content thead,#sbo-rt-content tdiv{vertical-align:top}#sbo-rt-content tbody+tbody tr:first-child td{padding-top:1em}#sbo-rt-content .ExternalTable{background-color:#F8F8F8;border-top:1px solid;border-bottom:1px solid;margin-top:1em;margin-bottom:1em;padding-top:0;padding-bottom:0}#sbo-rt-content .ExternalTable .Table{padding-bottom:.3em}#sbo-rt-content .UnorderedList>.Heading{font-size:1em;font-style:italic;font-weight:normal;margin-top:0;margin-bottom:0}#sbo-rt-content .Heading+.Para>div.UnorderedList:first-child>.Heading{margin-top:0}#sbo-rt-content .UnorderedList li .Para:first-child{text-indent:0}#sbo-rt-content .Heading+ul{margin-top:0}#sbo-rt-content ul{margin-top:.5em;margin-bottom:.5em}#sbo-rt-content ul.UnorderedListMarkBullet{list-style-type:disc;padding-left:1em}#sbo-rt-content ul.UnorderedListMarkBullet div{margin-bottom:.3em}#sbo-rt-content ul.UnorderedListMarkBullet .Equation div{margin-bottom:0}#sbo-rt-content ul.UnorderedListMarkNone{list-style-type:none;padding-left:1em}#sbo-rt-content ul.UnorderedListMarkNone div{margin-bottom:.3em}#sbo-rt-content ul.UnorderedListMarkNone .Equation div{margin-bottom:0}#sbo-rt-content ul.UnorderedListMarkDash{list-style:none;padding-left:1.1em;text-indent:-.8em}#sbo-rt-content ul.UnorderedListMarkDash>li>*:first-child{display:inline}#sbo-rt-content ul.UnorderedListMarkDash div{text-indent:0;margin-top:.3em;margin-bottom:.3em}#sbo-rt-content ul.UnorderedListMarkDash>li:before{content:"– "}#sbo-rt-content .Verse{margin-top:1em;margin-bottom:1em}#sbo-rt-content .Verse .Heading{font-size:1rem;margin-top:1em;margin-bottom:1em;text-indent:0}#sbo-rt-content .Acknowledgments,#sbo-rt-content .AuthorContribution,#sbo-rt-content .Ethics{margin-top:1em}#sbo-rt-content .Acknowledgments>.Heading,#sbo-rt-content .AuthorContribution>.Heading,#sbo-rt-content .FundingInformation>.Heading,#sbo-rt-content .DataAvailability>.Heading,#sbo-rt-content .Ethics>.Heading{font-size:1.2rem;margin-bottom:0}#sbo-rt-content .License{font-size:.9rem !important;margin-top:1em;margin-bottom:1em}#sbo-rt-content .License>a:first-child img{float:left;height:1.9rem;padding-right:.5em;padding-bottom:0;padding-top:.2em}#sbo-rt-content .Glossary{border-top:1px solid #bbb;margin-top:1em;margin-bottom:1em;padding-top:.3em}#sbo-rt-content .Glossary .Headings{margin-top:.8em;margin-bottom:.8em}#sbo-rt-content .Glossary>.Headings>.Heading{font-size:1.44rem;margin:0}#sbo-rt-content .Glossary>.Headings>.SubHeading{font-size:1.2rem}#sbo-rt-content .GlossarySection .Headings{margin-top:.8em;margin-bottom:.4em}#sbo-rt-content .GlossarySection>.Headings>.Heading{font-size:1.2rem;margin:0}#sbo-rt-content .GlossarySection>.Headings>.SubHeading{font-size:100%}#sbo-rt-content .GlossaryTerm{float:left;font-style:italic;padding-right:.5em}#sbo-rt-content .GlossarySeeLabel,#sbo-rt-content .GlossarySeeAlsoLabel{font-style:italic;padding-right:.3em}#sbo-rt-content .GlossaryDef{display:inline;margin-top:.3em}#sbo-rt-content .GlossaryDef>.SimplePara,#sbo-rt-content .GlossaryDef>.GlossarySee,#sbo-rt-content .GlossaryDef>.GlossarySeeAlso{display:block}#sbo-rt-content .GlossaryDef>:first-child{display:inline;margin-top:0;margin-left:0}#sbo-rt-content .GlossaryDef .SimplePara+.GlossarySee,#sbo-rt-content .GlossaryDef .SimplePara+.GlossarySeeAlso{text-indent:0}#sbo-rt-content .GlossaryTerm{display:inline}#sbo-rt-content .GlossaryTerm+.GlossarySee,#sbo-rt-content .GlossaryTerm+.GlossarySeeAlso{display:inline}#sbo-rt-content .InternalRefGlossaryEntry{border-bottom:thin dotted;cursor:help}#sbo-rt-content .InternalRefGlossaryEntry:hover{border-bottom:none}#sbo-rt-content .InternalRefGlossaryEntry a:link,#sbo-rt-content .InternalRefGlossaryEntry a:active,#sbo-rt-content .InternalRefGlossaryEntry a:visited{color:inherit}#sbo-rt-content .InternalRefGlossaryEntry .InlineGlossaryDefinition{background:#fff;display:none;margin:0 3em 0 2em;padding:3px 3px 3px 6px;border-style:solid;border-color:#49546F;border-width:2px;border-radius:5px;box-shadow:5px 5px 5px #888}#sbo-rt-content .InternalRefGlossaryEntry:hover .InlineGlossaryDefinition{display:block;z-index:6}#sbo-rt-content .TocAppendix{border-top:1px solid #bbb;margin-top:1em;padding-top:1em}#sbo-rt-content .BookContextInformation+.Appendix>.TocAppendix:first-child{border-top:none;padding-top:0}#sbo-rt-content .TocAppendix .Headings{margin-bottom:.5em}#sbo-rt-content .TocAppendix>.Headings>.Heading{font-size:1.44rem;margin:0}#sbo-rt-content .TocAppendix>.Headings>.SubHeading{font-size:1.2rem}#sbo-rt-content .TocEntry,#sbo-rt-content .TocPart,#sbo-rt-content .TocBack{margin-top:.5em;text-align:left !important}#sbo-rt-content .TocItem{font-weight:bold}#sbo-rt-content .TocPageNumber{display:none}#sbo-rt-content .TocAuthors{padding-left:1.5em}#sbo-rt-content .TocSection1,#sbo-rt-content .TocSection2,#sbo-rt-content .TocSection3,#sbo-rt-content .TocSection4,#sbo-rt-content .TocSection5,#sbo-rt-content .TocSection6,#sbo-rt-content .TocSection7{padding-left:1.5em}#sbo-rt-content .Index{border-top:1px solid #bbb;margin-top:1em;padding-top:.3em;margin-bottom:.8em}#sbo-rt-content .BookBackmatter>.Index:first-child{border-top:none;margin-top:0}#sbo-rt-content .Index .Headings{margin-top:.8em;margin-bottom:.1em}#sbo-rt-content .BookBackmatter>.Index:first-child>.Headings{margin-top:0}#sbo-rt-content .Index>.Headings>.Heading{font-size:1.44rem;margin:0}#sbo-rt-content .Index>.Headings>.SubHeading{font-size:1.2rem}#sbo-rt-content .IndexDiv .Headings{margin-top:.5em;margin-bottom:.1em}#sbo-rt-content .IndexDiv>.Headings>.Heading{font-size:1.2rem;margin:0}#sbo-rt-content .IndexDiv>.Headings>.SubHeading{font-size:100%;font-style:italic}#sbo-rt-content .IndexEntrySeeLabel{font-style:italic;margin-left:1em;padding-right:.3em}#sbo-rt-content .SecondaryIE{margin-left:1em}#sbo-rt-content .TertiaryIE{margin-left:2em}#sbo-rt-content .ChangeHistory{border-top:1px solid #bbb;margin-top:1em}#sbo-rt-content .ChangeHistory>.Heading{font-size:1.44rem;margin-top:.8em;margin-bottom:.3em}#sbo-rt-content .ChangeDate{font-weight:bold;padding-right:1em}#sbo-rt-content .ChangeDetails{display:inline}#sbo-rt-content .ChangeDetails>p:first-of-type{display:inline}#sbo-rt-content .Bibliography{border-top:1px solid #bbb;margin-top:1em}#sbo-rt-content .BookBackmatter>.Bibliography:first-child{border-top:none}#sbo-rt-content .Bibliography>.Heading{font-size:1.44rem;margin-top:.8em;margin-bottom:.1em}#sbo-rt-content .BibliographyWrapper{display:table;margin:0;padding:0}#sbo-rt-content .Bibliography>.BibliographyWrapper{padding-top:1em}#sbo-rt-content .Bibliography>.Heading+.BibliographyWrapper{padding-top:0}#sbo-rt-content .BibSection>.Heading{font-size:1.2rem;margin-top:.8em;margin-bottom:.2em}#sbo-rt-content .BibliographyWrapper>.BibSection:first-child>.Heading:first-child{margin-top:.3em}#sbo-rt-content .Citation{display:table-row;font-size:90%}#sbo-rt-content .CitationNumber{display:table-cell}#sbo-rt-content .CitationNumber+.CitationContent{padding-left:.5em;text-align:left}#sbo-rt-content .CitationContent{padding-top:1em;display:table-cell}#sbo-rt-content .BibliographyWrapper>.Citation:first-child>.CitationContent{padding-top:0}#sbo-rt-content .Occurrences{display:block}#sbo-rt-content .Occurrence{margin-right:0}#sbo-rt-content .Occurrence:before{content:"["}#sbo-rt-content .Occurrence:after{content:"]"}#sbo-rt-content .Citation .ArticleTitle:before,#sbo-rt-content .Citation .ChapterTitle:before{content:" “";}#sbo-rt-content .Citation .ArticleTitle,#sbo-rt-content .Citation .ChapterTitle{display:inline}#sbo-rt-content .Citation .ArticleTitle:after{content:"”\ ";}#sbo-rt-content .Citation .ChapterTitle:after{content:"”\ In: ";}#sbo-rt-content .Citation .Year:before{content:" ("}#sbo-rt-content .Citation .Year:after{content:") "}#sbo-rt-content .Citation .JournalTitle:after{content:" "}#sbo-rt-content .Citation .VolumeID:after{content:":"}#sbo-rt-content .BibChapter .FirstPage:before,#sbo-rt-content .BibBook .FirstPage:before{content:", pp "}#sbo-rt-content .Citation .FirstPage+.LastPage:before{content:"–";}#sbo-rt-content .Citation .BookTitle:after,#sbo-rt-content .Citation .BibEditorName:after,#sbo-rt-content .Citation .EditionNumber:after,#sbo-rt-content .Citation .PublisherName:after{content:", "}#sbo-rt-content .BibComments{display:block}#sbo-rt-content .CoverFigure img{margin:0 auto 6px;width:100%;max-width:480px;height:auto}#sbo-rt-content .SeriesTitlePage{padding-bottom:1.5em;padding-top:1em}#sbo-rt-content .SeriesTitlePage .VolumeNumber{font-size:1.44rem}#sbo-rt-content .SeriesTitlePage span.SeriesTitle{display:block;font-size:1.73rem;font-weight:bold;margin-top:.5em}#sbo-rt-content .SeriesTitlePage .SeriesSubTitle{display:block;font-size:1.44rem;font-weight:bold}#sbo-rt-content .SeriesTitlePage .SubSeriesTitle{display:block;font-size:1.44rem;font-weight:bold;margin-top:.5em}#sbo-rt-content .SeriesTitlePage .SubSeriesSubTitle{display:block;font-size:1.2rem;font-weight:bold}#sbo-rt-content .SeriesTitlePage .CollaboratorDesignation{display:block;font-weight:bold;padding-top:3em}#sbo-rt-content .SeriesTitlePage .Collaborators{display:block}#sbo-rt-content .SeriesTitlePage .AffiliationText{font-style:italic;margin-left:0}#sbo-rt-content .SeriesTitlePage .Affiliation+.CollaboratorName{display:inline-block;margin-top:1em}#sbo-rt-content .SeriesInformationText{padding-top:3em}#sbo-rt-content .BookTitlePage{padding-top:1em}#sbo-rt-content .BookTitlePageAfterSeriesTitlePage{border-top:1px solid #bbb;page-break-before:always}#sbo-rt-content .BookContextInformation+.BookTitlePage{border-top:none;padding-top:0}#sbo-rt-content .BookTitlePage .BookEditors,#sbo-rt-content .BookTitlePage .BookAuthors,#sbo-rt-content .BookTitlePage .BookEditorInChiefGroup,#sbo-rt-content .BookTitlePage .BookSectionEditorGroup{text-align:left !important}#sbo-rt-content .BookTitlePage .BookEditorInChiefGroup,#sbo-rt-content .BookTitlePage .BookSectionEditorGroup{margin-top:1em}#sbo-rt-content .BookTitlePage .BookEditorGroup .CollaboratorDesignation,#sbo-rt-content .BookTitlePage .BookEditorInChiefGroup .CollaboratorDesignation,#sbo-rt-content .BookTitlePage .BookSectionEditorGroup .CollaboratorDesignation{font-style:italic}#sbo-rt-content .BookTitlePage .BookTitle{display:block;font-size:1.73rem;font-weight:bold;margin-top:1em}#sbo-rt-content .BookTitlePage .BookSubTitle{display:block;font-size:1.44rem;font-weight:bold;margin-bottom:.5em}#sbo-rt-content .BookTitlePage .BookEdition{display:block;font-size:1rem;font-weight:normal;margin-top:.5em}#sbo-rt-content .BookTitlePage .CollaboratorLine{padding-top:.5em}#sbo-rt-content .BookFeatureText{margin-top:.5em}#sbo-rt-content .BookTitlePage .PublisherLogo .Figure,#sbo-rt-content .BookTitlePage .PublisherImprintName{font-size:1.2rem;margin-top:4em;margin-bottom:1.5em;text-align:left}#sbo-rt-content .CopyrightPage{border-top:1px solid #bbb;padding-top:1em;padding-bottom:1em;page-break-before:always}#sbo-rt-content .CopyrightPage .CollaboratorDesignation{display:block;font-style:italic;padding-bottom:.5em}#sbo-rt-content .CopyrightPageOriginators{padding-bottom:4em}#sbo-rt-content .CopyrightPage div+.CollaboratorDesignation{padding-top:2em}#sbo-rt-content .CopyrightPage .EditorGroup+.AuthorGroup{padding-top:2em}#sbo-rt-content .CopyrightPage .Author+.Author,#sbo-rt-content .CopyrightPage .Author+.InstitutionalAuthor,#sbo-rt-content .CopyrightPage .InstitutionalAuthor+.Author,#sbo-rt-content .CopyrightPage .InstitutionalAuthor+.InstitutionalAuthor,#sbo-rt-content .CopyrightPage .Editor+.Editor,#sbo-rt-content .CopyrightPage .Editor+.InstitutionalEditor,#sbo-rt-content .CopyrightPage .InstitutionalEditor+.Editor,#sbo-rt-content .CopyrightPage .InstitutionalEditor+.InstitutionalEditor,#sbo-rt-content .CopyrightPage .Collaborator+.Collaborator{padding-top:1em}#sbo-rt-content .CopyrightPage .Affiliation{margin-top:0}#sbo-rt-content .CopyrightPage .AffiliationText{margin-left:0}#sbo-rt-content .CopyrightPage .CollaboratorLine{padding-top:1em}#sbo-rt-content .CopyrightPage .CollaboratorLineTranslatedBy{padding-top:2em}#sbo-rt-content .CopyrightPage .CollaboratorLine .CollaboratorDesignation{display:inline;font-style:normal}#sbo-rt-content .BookFrontmatter .CopyrightPage .ArticleNoteESMHint,#sbo-rt-content .BookFrontmatter .CopyrightPage .ArticleNoteMoreMedia{border:none;padding-bottom:0;page-break-before:auto}#sbo-rt-content .CopyrightPageISBNs,#sbo-rt-content .CopyrightPageISSNs,#sbo-rt-content .SpringerLocationsLine,#sbo-rt-content .CatalogingInformation,#sbo-rt-content .MathematicsSubjectClassification,#sbo-rt-content .CopyrightLine,#sbo-rt-content .CopyrightPage .CopyrightComment,#sbo-rt-content .BookCopublishingInformation .SimplePara,#sbo-rt-content .CopyrightStandardText,#sbo-rt-content .TrademarkQualifierText,#sbo-rt-content .ProductLiability,#sbo-rt-content .LegalNotice,#sbo-rt-content .CoverDesigner,#sbo-rt-content .BookCoverFigureText,#sbo-rt-content .PaperInfo,#sbo-rt-content .SpringerReferenceLine{margin-top:1em}#sbo-rt-content .CopyrightComment+.CopyrightLine{margin-top:.5em}#sbo-rt-content .SeriesTitle+.CopyrightPageISBNs,#sbo-rt-content .SubSeriesTitle+.CopyrightPageISBNs{margin-top:0}#sbo-rt-content .CopyrightPage .SeriesTitle{display:block;margin-top:1em}#sbo-rt-content .SeriesTitle+.CopyrightPageISSNs,#sbo-rt-content .CopyrightPageISSNs+.SeriesTitle,#sbo-rt-content .CopyrightPageISSNs+.SubSeriesTitle{margin-top:0}#sbo-rt-content .CopyrightPagePrintISSN,#sbo-rt-content .CopyrightPagePrintISBN{display:inline-block;min-width:12em}#sbo-rt-content .SpringerReferenceLine .SimplePara+.SimplePara,#sbo-rt-content .BookCoverFigureText .SimplePara+.SimplePara,#sbo-rt-content .BookCopublishingInformation .SimplePara+.SimplePara{text-indent:0}#sbo-rt-content .CopyrightPagePrintISSN+.CopyrightPageElectronicISSN{padding-left:1.5em}#sbo-rt-content .CopyrightPagePrintISBN+.CopyrightPageElectronicISBN{padding-left:1.5em}#sbo-rt-content .CopyrightComment .SimplePara+.SimplePara{padding-top:.5em;text-indent:0}#sbo-rt-content .BookCorrectionYear:before{content:", "}#sbo-rt-content .BookCorrectionYear .Year:first-of-type:before{content:" "}#sbo-rt-content .BookCorrectionYear .Year+.Year:before{content:", "}#sbo-rt-content .MathematicsSubjectClassificationCode+.MathematicsSubjectClassificationCode:before{content:", "}#sbo-rt-content .Endorsement{border-top:1px solid #bbb;padding-top:1em;padding-bottom:1em;page-break-before:always}#sbo-rt-content .Frontispiece{border-top:1px solid #bbb;padding-top:1em;padding-bottom:1em;page-break-before:always}#sbo-rt-content .Dedication{border-top:1px solid #bbb;padding-top:1em;padding-bottom:1em;page-break-before:always}#sbo-rt-content .Foreword{border-top:1px solid #bbb;padding-top:1em;padding-bottom:1em;page-break-before:always}#sbo-rt-content .PartFrontmatter h1:first-child+.Foreword{border-top:none;padding-top:0;page-break-before:auto}#sbo-rt-content .ForewordTitle{font-size:1.44rem;font-weight:bold;padding-bottom:.1em;page-break-after:avoid}#sbo-rt-content .Foreword .AuthorName{margin-top:.2em}#sbo-rt-content .Foreword .AuthorName,#sbo-rt-content .ForewordLocations,#sbo-rt-content .ForewordDate{font-weight:bold;text-align:right}#sbo-rt-content .ForewordLocation+.ForewordLocation:before{content:", "}#sbo-rt-content .Foreword .RenderAsSection1>.Heading{font-size:1.2rem}#sbo-rt-content .Foreword .RenderAsSection2>.Heading,#sbo-rt-content .Foreword .RenderAsSection3>.Heading{font-size:100%}#sbo-rt-content .Preface{border-top:1px solid #bbb;padding-top:1em;padding-bottom:1em;page-break-before:always}#sbo-rt-content .PrefaceTitle{font-size:1.44rem;font-weight:bold;padding-bottom:.1em;page-break-after:avoid}#sbo-rt-content .Preface .AuthorName{margin-top:.2em}#sbo-rt-content .Preface .AuthorName,#sbo-rt-content .PrefaceLocations,#sbo-rt-content .PrefaceDate{font-weight:bold;text-align:right}#sbo-rt-content .PrefaceLocation+.PrefaceLocation:before{content:", "}#sbo-rt-content .Preface .RenderAsSection1>.Heading{font-size:1.2rem}#sbo-rt-content .Preface .RenderAsSection2>.Heading,#sbo-rt-content .Preface .RenderAsSection3>.Heading{font-size:100%}#sbo-rt-content .BookFrontmatterArticleNote{border-top:1px solid #bbb;margin-top:0;padding-top:1em;padding-bottom:1em;page-break-before:always}#sbo-rt-content .PartFrontmatter .ArticleNote{padding-bottom:1em}#sbo-rt-content .PartFrontmatter h1:first-child+.ArticleNote{border-top:none;page-break-before:auto}#sbo-rt-content .BookFrontmatter .ArticleNote .Heading,#sbo-rt-content .PartFrontmatter .ArticleNote .Heading{font-size:1.44rem;font-style:normal;padding-bottom:.1em;page-break-after:avoid}#sbo-rt-content .BookAcknowledgments{border-top:1px solid #bbb;padding-top:1em;padding-bottom:1em;page-break-before:always}#sbo-rt-content .BookAcknowledgmentsTitle{font-size:1.44rem;font-weight:bold;padding-bottom:.1em;page-break-after:avoid}#sbo-rt-content .BookAcknowledgments .AuthorName{font-weight:bold;margin-top:1em}#sbo-rt-content .BookAcknowledgments .RenderAsSection1>.Heading{font-size:1.2rem}#sbo-rt-content .BookAcknowledgments .RenderAsSection2>.Heading,#sbo-rt-content .BookAcknowledgments .RenderAsSection3>.Heading{font-size:100%}#sbo-rt-content .BookNotes{border-top:1px solid #bbb;padding-top:1em;padding-bottom:1em;page-break-before:always}#sbo-rt-content .BookNotesTitle{font-size:1.44rem;font-weight:bold;margin-bottom:.1em;page-break-after:avoid}#sbo-rt-content .BookNotes .AuthorName{font-weight:bold}#sbo-rt-content .BookFrontmatterAbbreviationGroup{border-top:1px solid #bbb;margin-top:0;padding-bottom:1em;page-break-before:always}#sbo-rt-content .PartFrontmatter .AbbreviationGroup{padding-bottom:1em;margin-top:1em}#sbo-rt-content .BookFrontmatter .AbbreviationGroup .Heading,#sbo-rt-content .PartFrontmatter .AbbreviationGroup .Heading{font-size:1.44rem;font-weight:bold;padding-top:1em;padding-bottom:.1em;page-break-after:avoid}#sbo-rt-content .BookFrontmatter .AbbreviationGroupSection>.Heading,#sbo-rt-content .PartFrontmatter .AbbreviationGroupSection>.Heading{font-size:1.2rem;padding-top:1em;padding-bottom:0}#sbo-rt-content .BookFrontmatter .AbbreviationGroupSection+.AbbreviationGroupSection>.Heading,#sbo-rt-content .PartFrontmatter .AbbreviationGroupSection+.AbbreviationGroupSection>.Heading{padding-top:.5em}#sbo-rt-content .Toc{border-top:1px solid #bbb;margin-top:0;padding-bottom:1em;page-break-before:always}#sbo-rt-content .Toc .Headings{margin-bottom:.5em}#sbo-rt-content .Toc>.Headings>.Heading{font-size:1.44rem;margin:0}#sbo-rt-content .Toc>.Headings>.SubHeading{font-size:1.2rem}#sbo-rt-content .Loh{border-top:1px solid #bbb;padding-bottom:1em;padding-top:1em;page-break-before:always}#sbo-rt-content .Loh .Headings{margin-bottom:.1em}#sbo-rt-content .Loh>.Headings>.Heading{font-size:1.44rem;margin:0}#sbo-rt-content .Loh>.Headings>.SubHeading{font-size:1.2rem}#sbo-rt-content .LohPageNumber{display:none}#sbo-rt-content .LocWithHeading,#sbo-rt-content .LocWithoutHeading>.LocBody>.LocDiv{border-top:1px solid #bbb;padding-bottom:1em;padding-top:1em;page-break-before:always}#sbo-rt-content .Loc .Headings{margin-bottom:.1em}#sbo-rt-content .LocWithHeading>.Headings>.Heading,#sbo-rt-content .LocWithoutHeading>.LocBody>.LocDiv>.Headings>.Heading{font-size:1.44rem;margin:0}#sbo-rt-content .LocWithHeading>.Headings>.SubHeading,#sbo-rt-content .LocWithoutHeading>.LocBody>.LocDiv>.Headings>.SubHeading{font-size:1.2rem}#sbo-rt-content .LocWithHeading .LocDiv{margin-top:1em}#sbo-rt-content .LocWithHeading .LocDiv .Heading{font-size:1.2rem;margin-bottom:.1em}#sbo-rt-content .LocWithHeading .LocDiv .SubHeading{font-size:100%;font-style:italic;font-weight:normal}#sbo-rt-content .LocDiv .FormalPara .Heading{font-size:100%}#sbo-rt-content .Loc .AuthorGroup+.AuthorGroup,#sbo-rt-content .Loc .AuthorGroup+.EditorGroup,#sbo-rt-content .Loc .EditorGroup+.AuthorGroup,#sbo-rt-content .Loc .EditorGroup+.EditorGroup{margin-top:1em}#sbo-rt-content .Loc .Author,#sbo-rt-content .Loc .Editor,#sbo-rt-content .Loc .InstitutionalAuthor,#sbo-rt-content .Loc .InstitutionalEditor{font-weight:bold}#sbo-rt-content .Loc .AffiliationText{margin-left:0}#sbo-rt-content .Loc .Email+.Email:before{content:", "}#sbo-rt-content .Loc .Emails,#sbo-rt-content .Loc .URLs{display:inline}#sbo-rt-content .Loc .Emails+.URLs:before{content:", "}#sbo-rt-content .Loc .URL+.URL:before{content:", "}#sbo-rt-content .BookFrontmatterFootnoteSection{border-top:1px solid #bbb;margin-top:0;page-break-before:always}#sbo-rt-content .PartFrontmatter .FootnoteSection{border-top:none;margin-top:0}#sbo-rt-content .Colophon{border-top:1px solid #bbb;margin-top:1em;padding-top:.8em;font-style:italic}#sbo-rt-content .ConferenceInfo{border-top:1px solid #bbb;margin-top:1em;padding-top:.8em}#sbo-rt-content .ConfEventAbbreviation,#sbo-rt-content .ConfNumber+.ConfSeriesName,#sbo-rt-content .ConfEventAbbreviation+.Year,#sbo-rt-content .ConfEventDateStart,#sbo-rt-content .ConfEventDateEnd{display:inline}#sbo-rt-content .ConfEventAbbreviation:after{content:" "}#sbo-rt-content .ConfEventLocation .City:after{content:", "}#sbo-rt-content .ConfEventDateEnd:before{content:"–"}#sbo-rt-content .ConfEventDateStart .Year:after,#sbo-rt-content .ConfEventDateStart .Month:after,#sbo-rt-content .ConfEventDateEnd .Year:after,#sbo-rt-content .ConfEventDateEnd .Month:after{content:"/"}#sbo-rt-content .ConfEventDate .Month:after{content:"/"}</style><script id="twitter-wjs" src="https://platform.twitter.com/widgets.js"></script><script type="text/javascript" async="" src="./10. Microservice Performance - Practical Microservices Architectural Patterns_ Event-Based Java Microservices with Spring Boot and Spring Cloud_files/cool-2.1.15.min.j.下载"></script><script crossorigin="anonymous" integrity="sha256-4akcsqklmUmtNjRgapND1hbNA1NRfbSO24PnriCCqNI=" type="text/javascript" src="./10. Microservice Performance - Practical Microservices Architectural Patterns_ Event-Based Java Microservices with Spring Boot and Spring Cloud_files/appcues.main.37d7.下载" async=""></script><script type="text/javascript" async="" src="./10. Microservice Performance - Practical Microservices Architectural Patterns_ Event-Based Java Microservices with Spring Boot and Spring Cloud_files/ec.js.下载"></script><script async="" src="./10. Microservice Performance - Practical Microservices Architectural Patterns_ Event-Based Java Microservices with Spring Boot and Spring Cloud_files/fbevents.js.下载"></script><script type="text/javascript" async="" src="./10. Microservice Performance - Practical Microservices Architectural Patterns_ Event-Based Java Microservices with Spring Boot and Spring Cloud_files/f.txt"></script><script type="text/javascript" async="" src="./10. Microservice Performance - Practical Microservices Architectural Patterns_ Event-Based Java Microservices with Spring Boot and Spring Cloud_files/analytics.js.下载"></script><script type="text/javascript" async="" src="./10. Microservice Performance - Practical Microservices Architectural Patterns_ Event-Based Java Microservices with Spring Boot and Spring Cloud_files/bat.js.下载"></script><script type="text/javascript" async="" src="./10. Microservice Performance - Practical Microservices Architectural Patterns_ Event-Based Java Microservices with Spring Boot and Spring Cloud_files/f.txt"></script><script type="text/javascript" async="" src="./10. Microservice Performance - Practical Microservices Architectural Patterns_ Event-Based Java Microservices with Spring Boot and Spring Cloud_files/insight.min.js.下载"></script><script type="text/javascript" async="" src="./10. Microservice Performance - Practical Microservices Architectural Patterns_ Event-Based Java Microservices with Spring Boot and Spring Cloud_files/f.txt"></script><script async="" src="./10. Microservice Performance - Practical Microservices Architectural Patterns_ Event-Based Java Microservices with Spring Boot and Spring Cloud_files/gtm.js.下载"></script><script> // <![CDATA[
    var g = {
      position_cache: {
        
          "chapter": "/api/v1/book/9781484245019/chapter/html/477630_1_En_11_Chapter.xhtml",
          "book_id": "9781484245019",
          "chapter_uri": "html/477630_1_En_11_Chapter.xhtml",
          "position": 0,
          "user_uuid": "6d9ee17b-34b1-4bf4-bdae-19676bd84ca1",
          "next_chapter_uri": "/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_12_Chapter.xhtml"
        
      },
      title: "Practical Microservices Architectural Patterns: Event\u002DBased Java Microservices with Spring Boot and Spring Cloud",
      author_list: "Binildas Christudas",
      format: "book",
      source: "application/epub+zip",
      is_system_book: true,
      is_public: false,
      loaded_from_server: true,
      allow_scripts: false,
      has_mathml: false
    };
    // ]]></script><script src="./10. Microservice Performance - Practical Microservices Architectural Patterns_ Event-Based Java Microservices with Spring Boot and Spring Cloud_files/modernizr.8e35451.下载"></script><script>
    
      

      
        
          window.PUBLIC_ANNOTATIONS = true;
        
      

      window.MOBILE_PUBLIC_ANNOTATIONS = false;

    

    
      window.PRIVACY_CONTROL_OVERRIDE = false;
    

      window.PRIVACY_CONTROL_SWITCH = true;

      window.PUBLISHER_PAGES = true;

      window.SBO = {
        "constants": {
          "SITB_ENDPOINT": "/api/v2/sitb/",
          "SEARCH_SELECT_ENDPOINT": "https://learning.oreilly.com/api/v2/search/select/",
          "ENABLE_ONLINE_TRAINING": true
        }
      };
  </script><link rel="canonical" href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_11_Chapter.xhtml"><meta name="description" content="© Binildas Christudas 2019 Binildas ChristudasPractical Microservices Architectural Patternshttps://doi.org/10.1007/978-1-4842-4501-9_11 11. Events, Eventuality, and Consistency Binildas Christudas1  (1)Trivandrum, Kerala, India   A handshake with one of your colleagues ...!--end&gt;!--begin&gt; "><meta property="og:title" content="11. Events, Eventuality, and Consistency"><meta itemprop="isPartOf" content="/library/view/practical-microservices-architectural/9781484245019/"><meta itemprop="name" content="11. Events, Eventuality, and Consistency"><meta property="og:url" itemprop="url" content="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_11_Chapter.xhtml"><meta property="og:site_name" content="Safari"><meta property="og:image" itemprop="thumbnailUrl" content="https://learning.oreilly.com/library/cover/9781484245019/"><meta property="og:description" itemprop="description" content="© Binildas Christudas 2019 Binildas ChristudasPractical Microservices Architectural Patternshttps://doi.org/10.1007/978-1-4842-4501-9_11 11. Events, Eventuality, and Consistency Binildas Christudas1  (1)Trivandrum, Kerala, India   A handshake with one of your colleagues ...!--end&gt;!--begin&gt; "><meta itemprop="inLanguage" content="en"><meta itemprop="publisher" content="Apress"><meta property="og:type" content="book"><meta property="og:book:isbn" itemprop="isbn" content="9781484245019"><meta property="og:book:author" itemprop="author" content="Binildas Christudas"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@OReillyMedia"><style type="text/css" id="font-styles" data-template="#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-size: &lt;%= font_size %&gt; !important; }"></style><style type="text/css" id="font-family" data-template="#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-family: &lt;%= font_family %&gt; !important; }"></style><style type="text/css" id="column-width" data-template="#sbo-rt-content { max-width: &lt;%= column_width %&gt;% !important; margin: 0 auto !important; }"></style><noscript><meta http-equiv="refresh" content="0; url=/library/no-js/" /></noscript><script>
    var dataLayer = window.dataLayer || [];

    
      window.medalliaVsgUserIdentifier = '6d9ee17b-34b1-4bf4-bdae-19676bd84ca1';
      dataLayer.push({userIdentifier: '6d9ee17b-34b1-4bf4-bdae-19676bd84ca1'});
      dataLayer.push({loggedIn: 'yes'});

      
        window.medalliaVsgAccountIdentifier = '20b4a98e-dfa5-4bb6-bdfb-97a15a9c3f0d';
        
        dataLayer.push({orgID: '20b4a98e-dfa5-4bb6-bdfb-97a15a9c3f0d'});
        

        window.medalliaVsgIsIndividual = false;
        
          
          dataLayer.push({learningAccountType: 'enterprise'});
          
        

        
          dataLayer.push({learningPaidAccount: 'yes'});
        
      
    

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-5P4V6Z');
    (function () {
      var VERSION = 'V1.1';
      var AUTHOR = 'Awwad';
      if (!window.GtmHelper)
        window.GtmHelper = function () {
          var instance = this;
          var loc = document.location;
          this.version = VERSION;
          this.author = AUTHOR;
          this.readCookie = function (name) {
            var nameEQ = name + "=";
            var ca = document.cookie.split(';');
            for (var i = 0; i < ca.length; i++) {
              var c = ca[i];
              while (c.charAt(0) == ' ') c = c.substring(1, c.length);
              if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);
            }
            return null;
          };
          this.createCookie = function (name, value, days, cookieDomain) {
            var domain = "";
            var expires = "";

            if (days) {
              var date = new Date();
              date.setTime(date.getTime() + Math.ceil(days * 24 * 60 * 60 * 1000));
              var expires = " expires=" + date.toGMTString() + ";";
            }

            if (typeof (cookieDomain) != 'undefined')
              domain = " domain=" + cookieDomain + "; ";

            document.cookie = name + "=" + value + ";" + expires + domain + "path=/";
          };

          this.isDuplicated = function (currentTransactionId) {
            // the previous transaction id:
            var previousTransIdValue = this.readCookie("previousTransId");

            if (currentTransactionId === previousTransIdValue) {
              return true; // Duplication
            } else {
              return false;
            }
          };
        }
    })()
  </script><script defer="" src="./10. Microservice Performance - Practical Microservices Architectural Patterns_ Event-Based Java Microservices with Spring Boot and Spring Cloud_files/vendor.a7a9eda718.下载"></script><script defer="" src="./10. Microservice Performance - Practical Microservices Architectural Patterns_ Event-Based Java Microservices with Spring Boot and Spring Cloud_files/reader.90cfcafc75.下载"></script><script src="./10. Microservice Performance - Practical Microservices Architectural Patterns_ Event-Based Java Microservices with Spring Boot and Spring Cloud_files/f(1).txt"></script><script src="./10. Microservice Performance - Practical Microservices Architectural Patterns_ Event-Based Java Microservices with Spring Boot and Spring Cloud_files/f(2).txt"></script><script src="./10. Microservice Performance - Practical Microservices Architectural Patterns_ Event-Based Java Microservices with Spring Boot and Spring Cloud_files/f(3).txt"></script><iframe src="./10. Microservice Performance - Practical Microservices Architectural Patterns_ Event-Based Java Microservices with Spring Boot and Spring Cloud_files/saved_resource.html"></iframe><iframe src="./10. Microservice Performance - Practical Microservices Architectural Patterns_ Event-Based Java Microservices with Spring Boot and Spring Cloud_files/saved_res(1).html"></iframe><iframe src="./10. Microservice Performance - Practical Microservices Architectural Patterns_ Event-Based Java Microservices with Spring Boot and Spring Cloud_files/saved_res(2).html"></iframe><link rel="stylesheet" type="text/css" integrity="sha256-m9iQXscob5jO+vyfe0sovuV3lxwPoNxtAuVQYG3yl4o=" crossorigin="anonymous" href="./10. Microservice Performance - Practical Microservices Architectural Patterns_ Event-Based Java Microservices with Spring Boot and Spring Cloud_files/container.37d725.css"><iframe src="./10. Microservice Performance - Practical Microservices Architectural Patterns_ Event-Based Java Microservices with Spring Boot and Spring Cloud_files/saved_res(3).html"></iframe><script async="" src="./10. Microservice Performance - Practical Microservices Architectural Patterns_ Event-Based Java Microservices with Spring Boot and Spring Cloud_files/MathJax.js.下载"></script><style id="annotator-dynamic-style">.annotator-adder, .annotator-outer, .annotator-notice {
  z-index: 100019;
}
.annotator-filter {
  z-index: 100009;
}</style><style type="text/css" id="kampyleStyle">.noOutline{outline: none !important;}.wcagOutline:focus{outline: 1px dashed #595959 !important;outline-offset: 2px !important;transition: none !important;}</style></head>


<body class="reading sidenav  scalefonts library nav-collapsed">

    
  <noscript> 
    <iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P4V6Z"
            height="0" width="0"
            style="display:none;visibility:hidden">
    </iframe>
  </noscript>



    
      <div class="hide working" role="status">
        <div class="working-image"></div>
      </div>
      <div class="sbo-site-nav">
        

  


<a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#container" class="skip">Skip to content</a><header class="topbar t-topbar"><nav role="navigation" class="js-site-nav"><ul class="topnav"><li><a href="https://learning.oreilly.com/home/" class="l0 nav-icn"><svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M11.738 14H9.254v-3.676a.617.617 0 0 0-.621-.613H7.39a.617.617 0 0 0-.62.613V14H4.284a.617.617 0 0 1-.622-.613V10.22c0-.327.132-.64.367-.87l3.547-3.493a.627.627 0 0 1 .875 0l3.54 3.499c.234.229.366.54.367.864v3.167a.617.617 0 0 1-.62.613zM7.57 2.181a.625.625 0 0 1 .882 0l5.77 5.692-.93.92-5.28-5.209-5.28 5.208-.932-.919 5.77-5.692z"></path></svg><span>Home</span></a></li><li class="search"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#" class="t-search-nav trigger nav-icn l0" data-dropdown-selector=".searchbox"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="20" height="20" version="1.1" fill="#4A3C31"><desc>search icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M31.3 0C20.9 0 12.5 8.4 12.5 18.8 12.5 22.5 13.6 25.9 15.4 28.8L1.2 42.9C-0.4 44.5-0.4 47.2 1.2 48.8 2 49.6 3.1 50 4.2 50 5.2 50 6.3 49.6 7.1 48.8L21.2 34.6C24.1 36.5 27.5 37.5 31.3 37.5 41.6 37.5 50 29.1 50 18.8 50 8.4 41.6 0 31.3 0ZM31.3 31.3C24.4 31.3 18.8 25.6 18.8 18.8 18.8 11.9 24.4 6.3 31.3 6.3 38.1 6.3 43.8 11.9 43.8 18.8 43.8 25.6 38.1 31.3 31.3 31.3Z"></path></g></svg><span>Search</span></a></li><li class="usermenu dropdown"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#" class="trigger l0 nav-icn nav-dropdown"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20" version="1.1" fill="#4A3C31"><desc>navigation arrow</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M0.1 12.5L9.7 3.1C9.8 3 9.9 3 10 3 10.1 3 10.2 3 10.3 3.1L19.9 12.5C20 12.5 20 12.6 20 12.8 20 12.9 20 13 19.9 13L17 15.9C16.9 16 16.8 16 16.7 16 16.5 16 16.4 16 16.4 15.9L10 9.7 3.6 15.9C3.6 16 3.5 16 3.3 16 3.2 16 3.1 16 3 15.9L0.1 13C0 12.9 0 12.8 0 12.7 0 12.7 0 12.6 0.1 12.5Z"></path></g></svg><span>Expand Nav</span></a><div class="drop-content"><ul><li class="flyout-parent"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#" class="l1 nav-icn "><!--?xml version="1.0" encoding="UTF-8"?--><svg width="16px" height="16px" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M8,8 C6.34321755,8 5.00013,6.65691245 5.00013,5.00013 C5.00013,3.34334755 6.34321755,2.00026001 8,2.00026001 C9.65678245,2.00026001 10.99987,3.34334755 10.99987,5.00013 C10.99987,6.65691245 9.65678245,8 8,8 Z M2.33024571,11.3523547 L2.33774538,11.3523547 C3.7622187,9.70968996 5.82947484,8.76608166 8.00374984,8.76608166 C10.1780248,8.76608166 12.245281,9.70968996 13.6697543,11.3523547 C13.8892083,11.6177474 14.0062813,11.9530021 13.99974,12.2973138 L13.99974,13.99974 L2.00026001,13.99974 L2.00026001,12.2973138 C1.99371867,11.9530021 2.11079172,11.6177474 2.33024571,11.3523547 Z" id="path-1"></path></svg><span>Your O'Reilly</span></a><ul class="flyout"><li><a href="https://learning.oreilly.com/profile/" class="l2 nav-icn"><span>Profile</span></a></li><li><a href="https://learning.oreilly.com/history/" class="l2 nav-icn"><span>History</span></a></li><li><a href="https://learning.oreilly.com/playlists/" class="l2 nav-icn"><span>Playlists</span></a></li><li><a href="https://learning.oreilly.com/u/6d9ee17b-34b1-4bf4-bdae-19676bd84ca1/" class="l2 nav-icn"><span>Highlights</span></a></li></ul></li><li class="flyout-parent"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#" class="l1 nav-icn "><svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M11.564 2.263l2.172 2.174c.17.168.264.397.264.636V11a.6.6 0 0 1-.6.6h-.6V6.2h-6V2.6a.6.6 0 0 1 .6-.6h3.527c.239 0 .468.095.637.263zM2.6 14a.6.6 0 0 1-.6-.6V6.8a.6.6 0 0 1 .6-.6h1.903a1.2 1.2 0 0 1 .849.352L6.2 7.4H11a.6.6 0 0 1 .6.6v5.4a.6.6 0 0 1-.6.6H2.6zM11 5h1.8L11 3.2V5z"></path></svg><span>Featured</span></a><ul class="flyout"><li><a href="https://learning.oreilly.com/featured/navigating-21st-century/" class="l2 nav-icn"><span>Navigating Change</span></a></li><li><a href="https://learning.oreilly.com/recommendations/" class="l2 nav-icn"><span>Recommended</span></a></li></ul></li><li class="flyout-parent"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#" class="l1 nav-icn "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="20" height="20" version="1.1" fill="#4A3C31"><desc>queue icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M25 29.2C25.4 29.2 25.8 29.1 26.1 28.9L48.7 16.8C49.5 16.4 50 15.5 50 14.6 50 13.7 49.5 12.8 48.7 12.4L26.1 0.3C25.4-0.1 24.6-0.1 23.9 0.3L1.3 12.4C0.5 12.8 0 13.7 0 14.6 0 15.5 0.5 16.4 1.3 16.8L23.9 28.9C24.2 29.1 24.6 29.2 25 29.2ZM7.3 14.6L25 5.2 42.7 14.6 25 24 7.3 14.6ZM48.7 22.4L47.7 21.9 25 34.2 2.3 21.9 1.3 22.4C0.5 22.9 0 23.7 0 24.7 0 25.6 0.5 26.5 1.3 26.9L23.9 39.3C24.2 39.5 24.6 39.6 25 39.6 25.4 39.6 25.8 39.5 26.1 39.3L48.7 26.9C49.5 26.5 50 25.6 50 24.7 50 23.7 49.5 22.9 48.7 22.4ZM48.7 32.8L47.7 32.3 25 44.6 2.3 32.3 1.3 32.8C0.5 33.3 0 34.1 0 35.1 0 36 0.5 36.9 1.3 37.3L23.9 49.7C24.2 49.9 24.6 50 25 50 25.4 50 25.8 49.9 26.1 49.7L48.7 37.3C49.5 36.9 50 36 50 35.1 50 34.1 49.5 33.3 48.7 32.8Z"></path></g></svg><span>Explore</span></a><ul class="flyout"><li><a href="https://learning.oreilly.com/topics/" class="l2 nav-icn"><span>All Topics</span></a></li><li><a href="https://learning.oreilly.com/search/?query=&amp;extended_publisher_data=true&amp;highlight=true&amp;include_assessments=false&amp;include_case_studies=true&amp;include_courses=true&amp;include_orioles=true&amp;include_playlists=true&amp;include_collections=true&amp;include_notebooks=true&amp;is_academic_institution_account=false&amp;source=user&amp;formats=book&amp;sort=publication_date&amp;facet_json=true&amp;page=0" class="l2 nav-icn"><span>Early Releases</span></a></li><li><a href="https://learning.oreilly.com/playlists/discover/" class="l2 nav-icn"><span>Shared Playlists</span></a></li><li><a href="https://learning.oreilly.com/search/?query=&amp;extended_publisher_data=true&amp;highlight=true&amp;include_assessments=false&amp;include_case_studies=true&amp;include_courses=true&amp;include_orioles=true&amp;include_playlists=true&amp;include_collections=true&amp;include_notebooks=true&amp;is_academic_institution_account=false&amp;source=user&amp;formats=book&amp;formats=case%20study&amp;formats=learning%20path&amp;formats=live%20online%20training&amp;formats=notebook&amp;formats=oriole&amp;formats=video&amp;sort=popularity&amp;facet_json=true&amp;page=0&amp;collection_type=expert" class="l2 nav-icn"><span>Most Popular Titles</span></a></li><li><a href="https://learning.oreilly.com/resource-centers/" class="l2 nav-icn"><span>Resource Centers</span></a></li></ul></li><li class="flyout-parent"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#" class="l1 nav-icn "><svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M12.8 3.2A1.2 1.2 0 0 1 14 4.4v8.4a1.2 1.2 0 0 1-1.2 1.2H3.2A1.2 1.2 0 0 1 2 12.8V4.4a1.2 1.2 0 0 1 1.2-1.2h1.2V2h1.2v1.2h4.8V2h1.2v1.2h1.2zm-9.6 9.6h9.6V6.2H3.2v6.6zM8 9.5a1.35 1.35 0 1 1 0-2.7 1.35 1.35 0 0 1 0 2.7zm2.7 2.148v.552H5.3v-.552c0-.321.124-.634.355-.858a3.358 3.358 0 0 1 4.69 0c.23.224.355.537.355.858z"></path></svg><span>Live Events</span></a><ul class="flyout"><li><a href="https://learning.oreilly.com/featured/strata/" class="l2 nav-icn"><span>Strata</span></a></li><li><a href="https://learning.oreilly.com/featured/oscon/" class="l2 nav-icn"><span>Open Source</span></a></li><li><a href="https://learning.oreilly.com/featured/infrastructure-ops/" class="l2 nav-icn"><span>Infra &amp; Ops</span></a></li><li><a href="https://learning.oreilly.com/featured/software-architecture/" class="l2 nav-icn"><span>Software Arch</span></a></li></ul></li><li class="flyout-parent"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#" class="l1 nav-icn "><svg width="16px" height="16px" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M11.6467109,4.35328907 L14.7964612,7.51003884 C15.0678463,7.78304342 15.0678463,8.22395603 14.7964612,8.49696061 L11.6467109,11.6467109 L10.6597892,10.6597892 L13.3055794,8 L10.6597892,5.34021084 L11.6467109,4.35328907 Z M4.35328907,11.6467109 L1.20353875,8.48996116 C0.932153749,8.21695658 0.932153749,7.77604397 1.20353875,7.50303939 L4.35328907,4.35328907 L5.34021084,5.34021084 L2.69442057,8 L5.34021084,10.6597892 L4.35328907,11.6467109 Z M5.84417089,11.4997226 L8.67194674,4.50027742 L10.1838269,4.50027742 L7.35605105,11.4997226 L5.84417089,11.4997226 Z" id="Mask"></path></svg><span>Practice</span></a><ul class="flyout"><li><a href="https://learning.oreilly.com/scenarios/" class="l2 nav-icn"><span>Katacoda Scenarios</span></a></li><li><a href="https://learning.oreilly.com/interactive/#notebooks" class="l2 nav-icn"><span>Jupyter Notebooks</span></a></li></ul></li><li class="flyout-parent"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#" class="l1 nav-icn "><!--?xml version="1.0" encoding="UTF-8"?--><svg width="16px" height="16px" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M10.0440191,12.1582649 C10.177209,12.3351976 10.2476998,12.552011 10.2434767,12.7742985 L10.2434767,13.9482829 L1.96869684,13.9482829 L1.96869684,12.7742985 C1.96418597,12.536863 2.04491894,12.3056731 2.19625329,12.1226596 L2.20142503,12.1226596 C3.18373453,10.9898864 4.60930376,10.339179 6.10867266,10.339179 C7.30793519,10.339179 8.45998426,10.7554703 9.37576632,11.5017585 L14.3434936,11.5017585 L14.3434936,3.65650645 L1.65650645,3.65650645 L1.65650645,11.5017585 L2.06682298,11.5017585 L1.82063306,12.1582649 L1.32825322,12.1582649 C1.14771395,12.1582649 1,12.010551 1,11.8300117 L1,3.32825322 C1,3.14771395 1.14771395,3 1.32825322,3 L14.6717468,3 C14.852286,3 15,3.14771395 15,3.32825322 L15,11.8300117 C15,12.010551 14.852286,12.1582649 14.6717468,12.1582649 L10.0440191,12.1582649 Z M12.5483683,7.16419284 C12.6159362,7.20929881 12.6563112,7.2853432 12.6558247,7.36658194 C12.6553382,7.44782068 12.6140555,7.5233761 12.5459522,7.56766966 L10.4270949,8.91581376 C10.3903366,8.94010203 10.3431312,8.9419685 10.3045699,8.9206583 C10.2660086,8.89934811 10.2424712,8.85838696 10.2434767,8.81434055 L10.2434767,5.91510593 C10.2420711,5.86982855 10.2666257,5.82771857 10.3067229,5.80664182 C10.3468202,5.78556507 10.3954292,5.7892172 10.431927,5.81604875 L12.5483683,7.16419284 Z M6.10608679,9.81089299 C4.9635781,9.81089299 4.03739181,8.8847067 4.03739181,7.74219802 C4.03739181,6.59968933 4.9635781,5.67350304 6.10608679,5.67350304 C7.24859547,5.67350304 8.17478176,6.59968933 8.17478176,7.74219802 C8.17478176,8.8847067 7.24859547,9.81089299 6.10608679,9.81089299 Z"></path></svg><span>Sandboxes</span></a><ul class="flyout"><li><a href="https://learning.oreilly.com/scenarios/kubernetes-sandbox/9781492062820/" class="l2 nav-icn"><span>Kubernetes</span></a></li><li><a href="https://learning.oreilly.com/scenarios/python-sandbox/9781492062844/" class="l2 nav-icn"><span>Python</span></a></li><li><a href="https://learning.oreilly.com/scenarios/tensorflow-sandbox/9781492062851/" class="l2 nav-icn"><span>TensorFlow</span></a></li><li><a href="https://learning.oreilly.com/scenarios/ubuntu-sandbox/9781492062837/" class="l2 nav-icn"><span>Ubuntu</span></a></li></ul></li><li><a href="https://learning.oreilly.com/live-training/" class="l1 nav-icn "><svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M13.4 9.8a.6.6 0 0 1 .6.6v1.2h-1.2l-.6 2.4H3.8l-.6-2.4H2v-1.2a.6.6 0 0 1 .6-.6h10.8zM8 5.6a1.8 1.8 0 1 1-.001-3.599A1.8 1.8 0 0 1 8 5.6zm3.6 2.35v.95H4.4v-.95c0-.167.066-.33.19-.443A5.08 5.08 0 0 1 8 6.2a5.08 5.08 0 0 1 3.41 1.307c.124.113.19.276.19.444z"></path></svg><span>Attend</span></a></li><li><a href="https://learning.oreilly.com/certifications/" class="l1 nav-icn "><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path d="M12.912 9.18L14 8.014l-1.088-1.18a.304.304 0 01-.075-.268L13.195 5l-1.535-.463a.313.313 0 01-.194-.194l-.462-1.537-1.565.358c-.09.03-.194 0-.269-.074L8.007 2 6.845 3.09a.303.303 0 01-.269.074l-1.565-.358-.462 1.537a.313.313 0 01-.194.194L2.82 5l.358 1.567a.26.26 0 01-.075.269L2 8.015l1.088 1.164c.075.075.09.18.075.269l-.358 1.567 1.535.463c.09.03.164.104.194.194l.462 1.537 1.565-.358c.015 0 .045-.015.075-.015.075 0 .15.03.209.074L8.007 14l1.163-1.09a.303.303 0 01.269-.074l1.565.358.462-1.537a.313.313 0 01.194-.194L13.195 11l-.358-1.567a.338.338 0 01.075-.254zm-6.046 1.37L4.41 8.26l1.16-1.244 1.767 1.649L10.4 5.6l1.202 1.202-4.242 4.243-.495-.495z"></path></svg><span>Certifications</span></a></li><li><a href="https://get.oreilly.com/email-signup.html" class="l1 nav-icn " target="&quot;_blank&quot;"><svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M11.564 2.263l2.172 2.174c.17.168.264.397.264.636V11a.6.6 0 0 1-.6.6h-.6V6.2h-6V2.6a.6.6 0 0 1 .6-.6h3.527c.239 0 .468.095.637.263zM2.6 14a.6.6 0 0 1-.6-.6V6.8a.6.6 0 0 1 .6-.6h1.903a1.2 1.2 0 0 1 .849.352L6.2 7.4H11a.6.6 0 0 1 .6.6v5.4a.6.6 0 0 1-.6.6H2.6zM11 5h1.8L11 3.2V5z"></path></svg><span>Newsletters</span></a></li><li><a href="https://learning.oreilly.com/u/preferences/" class="l1 nav-icn "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 53" width="20" height="20" version="1.1" fill="#4A3C31"><desc>settings icon</desc><g stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M44.6 29.6C44.7 28.6 44.8 27.5 44.8 26.5 44.8 25.5 44.7 24.4 44.6 23.4L49.6 19C50 18.8 50.1 18.3 49.9 17.9 48.9 14.7 47.1 11.7 44.9 9.1 44.6 8.8 44.2 8.7 43.8 8.8L37.4 11.1C35.8 9.8 34 8.7 32.1 8L30.9 1.4C30.8 0.9 30.4 0.6 30 0.5 26.7-0.2 23.3-0.2 20 0.5 19.6 0.6 19.2 0.9 19.1 1.4L17.9 8C16 8.7 14.1 9.8 12.6 11.1L6.2 8.8C5.8 8.7 5.4 8.8 5.1 9.1 2.9 11.7 1.1 14.7 0.1 17.9 -0.1 18.3 0 18.8 0.4 19L5.4 23.4C5.3 24.4 5.2 25.5 5.2 26.5 5.2 27.5 5.3 28.6 5.4 29.6L0.4 34C0 34.2-0.1 34.7 0.1 35.1 1.1 38.3 2.9 41.4 5.1 43.9 5.4 44.2 5.8 44.4 6.2 44.2L12.6 42C14.1 43.2 16 44.3 17.9 45L19.1 51.7C19.2 52.1 19.6 52.5 20 52.5 21.6 52.8 23.3 53 25 53 26.7 53 28.4 52.8 30 52.5 30.4 52.5 30.8 52.1 30.9 51.7L32.1 45C34 44.3 35.8 43.2 37.4 42L43.8 44.2C44.2 44.4 44.6 44.2 44.9 43.9 47.1 41.4 48.9 38.3 49.9 35.1 50.1 34.7 50 34.2 49.6 34L44.6 29.6ZM25 36.4C19.6 36.4 15.2 32 15.2 26.5 15.2 21 19.6 16.6 25 16.6 30.4 16.6 34.8 21 34.8 26.5 34.8 32 30.4 36.4 25 36.4Z"></path></g></svg><span>Settings</span></a></li><li><a href="https://learning.oreilly.com/public/support/" class="l1 nav-icn "><svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M7.363 6.656a2.692 2.692 0 0 1-2.681-2.703c0-1.493 1.2-2.703 2.681-2.703a2.692 2.692 0 0 1 2.682 2.703c0 1.493-1.2 2.703-2.682 2.703zm4.023 2.027c-1.852 0-3.352 1.513-3.352 3.379H2v-1.534c-.006-.31.099-.612.295-.852a6.666 6.666 0 0 1 9.09-.993zm-.543.676h1.12v.304c.003.284.16.543.408.676a.766.766 0 0 0 .77 0l.303-.176.556.966-.302.176a.772.772 0 0 0-.362.676v.08a.772.772 0 0 0 .362.677l.302.21-.556.965-.302-.175a.766.766 0 0 0-.771 0 .778.778 0 0 0-.409.675v.352h-1.106v-.372a.778.778 0 0 0-.409-.676.766.766 0 0 0-.77 0l-.303.176-.556-.912.302-.176a.772.772 0 0 0 .362-.676v-.04-.04a.772.772 0 0 0-.362-.676l-.302-.176.556-.966.289.155a.766.766 0 0 0 .77 0 .778.778 0 0 0 .41-.676V9.36zm1.562 2.703c0-.271-.108-.531-.3-.722a1.001 1.001 0 0 0-.72-.292 1.01 1.01 0 0 0-.992 1.023 1.01 1.01 0 0 0 1.01 1.004 1.01 1.01 0 0 0 1.002-1.013z"></path></svg><span>Support</span></a></li><li><a href="https://learning.oreilly.com/accounts/logout/" class="l1 nav-icn "><svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M2.613 12.63A.607.607 0 0 1 2 12.03V3.602C2 3.269 2.274 3 2.613 3h5.515v1.204H3.226v7.223h4.902v1.203H2.613zM5.677 9.02V6.611h4.903V4.926a.301.301 0 0 1 .19-.274.31.31 0 0 1 .33.063l2.722 2.673a.594.594 0 0 1 0 .849L11.1 10.909a.31.31 0 0 1-.331.063.301.301 0 0 1-.19-.274V9.02H5.677z"></path></svg><span>Sign Out</span></a></li></ul></div></li></ul></nav></header>



      </div><script type="text/javascript" id="">!function(b,e,f,g,a,c,d){b.fbq||(a=b.fbq=function(){a.callMethod?a.callMethod.apply(a,arguments):a.queue.push(arguments)},b._fbq||(b._fbq=a),a.push=a,a.loaded=!0,a.version="2.0",a.queue=[],c=e.createElement(f),c.async=!0,c.src=g,d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d))}(window,document,"script","https://connect.facebook.net/en_US/fbevents.js");fbq("init","1732687426968531");fbq("track","PageView");</script>
<noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=1732687426968531&amp;ev=PageView&amp;noscript=1"></noscript><script type="text/javascript" id="">(function(){window.medalliaUserIdentifier=document.documentElement.dataset.userUuid;window.medalliaUserName=document.documentElement.dataset.username})();</script>
<script type="text/javascript" id="" src="./10. Microservice Performance - Practical Microservices Architectural Patterns_ Event-Based Java Microservices with Spring Boot and Spring Cloud_files/embed.js.下载"></script>
<script type="text/javascript" id="">!function(b,e,f,g,a,c,d){b.fbq||(a=b.fbq=function(){a.callMethod?a.callMethod.apply(a,arguments):a.queue.push(arguments)},b._fbq||(b._fbq=a),a.push=a,a.loaded=!0,a.version="2.0",a.queue=[],c=e.createElement(f),c.async=!0,c.src=g,d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d))}(window,document,"script","https://connect.facebook.net/en_US/fbevents.js");fbq("init","443792972845831");fbq("set","agent","tmgoogletagmanager","443792972845831");fbq("track","PageView");</script>
<noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=443792972845831&amp;ev=PageView&amp;noscript=1"></noscript>

<script type="text/javascript" id="">!function(b,e,f,g,a,c,d){b.fbq||(a=b.fbq=function(){a.callMethod?a.callMethod.apply(a,arguments):a.queue.push(arguments)},b._fbq||(b._fbq=a),a.push=a,a.loaded=!0,a.version="2.0",a.queue=[],c=e.createElement(f),c.async=!0,c.src=g,d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d))}(window,document,"script","https://connect.facebook.net/en_US/fbevents.js");fbq("init","443792972845831");fbq("track","PageView");</script>
<noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=443792972845831&amp;ev=PageView&amp;noscript=1"></noscript>

      <div id="container" class="application" style="height: auto;">
        
          <div class="nav-container clearfix">
            


            
            
          </div>

          

  <div class="js-toc">
    
      <div class="sbo-reading-menu sbo-menu-top"><section class="sbo-toc-container toc-menu"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#" class="sbo-toc-thumb"><span class="sbo-title ss-list"><h1><div class="visuallyhidden">Table of Contents for </div>
      
      Practical Microservices Architectural Patterns: Event-Based Java Microservices with Spring Boot and Spring Cloud
      
    </h1></span></a><div class="toc-contents"></div></section></div>

    

    <div class="interface-controls interface-controls-top">
      <ul class="interface-control-btns js-bitlist js-reader">
        <li class="js-search-in-archive search-in-archive t-search-in-archive"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#" title="Search in archive" class="js-search-controls search-controls" onclick="window.Appcues.track(&#39;SearchBook_HeronBook&#39;)"><span class="icon">Search in book...</span></a><form class="search-archive-bar js-search-form"><input type="search" name="query" placeholder="Search inside this book..." autocomplete="off"></form><div class="search-archive-results"><div class="js-sitb-results-region"></div></div></li><li class="queue-control"><div class="js-content-uri" data-content-uri="/api/v1/book/9781484245019/chapter/html/477630_1_En_11_Chapter.xhtml"><div class="js-collections-dropdown collections-dropdown menu-bit-cards" onclick="window.Appcues.track(&#39;AddPlaylist_HeronBook&#39;)"><div data-reactroot="" class="menu-dropdown-wrapper js-menu-dropdown-wrapper align-right"><img class="hidden" src="./10. Microservice Performance - Practical Microservices Architectural Patterns_ Event-Based Java Microservices with Spring Boot and Spring Cloud_files/ajax-transp.gif" alt="loading spinner"><div class="menu-control"><div class="control "><div class="js-playlists-menu"><button class="js-playlist-icon"><svg class="icon-add-to-playlist-sml" viewBox="0 0 16 14" version="1.1" xmlns="http://www.w3.org/2000/svg"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g fill-rule="nonzero" fill="#000000"><g transform="translate(-1.000000, 0.000000)"><rect x="5" y="0" width="12" height="2"></rect><title>Playlists</title><path d="M4.5,14 C6.43299662,14 8,12.4329966 8,10.5 C8,8.56700338 6.43299662,7 4.5,7 C2.56700338,7 1,8.56700338 1,10.5 C1,12.4329966 2.56700338,14 4.5,14 Z M2.5,10 L4,10 L4,8.5 L5,8.5 L5,10 L6.5,10 L6.5,11 L5,11 L5,12.5 L4,12.5 L4,11 L2.5,11 L2.5,10 Z"></path><circle cx="2" cy="5" r="1"></circle><circle cx="1.94117647" cy="1" r="1"></circle><rect x="5" y="4" width="12" height="2"></rect><rect x="9" y="8" width="8" height="2"></rect><rect x="9" y="12" width="8" height="2"></rect></g></g></g></svg><div class="js-playlist-addto-label">Add&nbsp;To</div></button></div></div></div></div></div></div></li><li class="js-font-control-panel font-control-activator"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#" data-push-state="false" id="font-controls" title="Change font size" aria-label="Change font size" onclick="window.Appcues.track(&#39;ChangeFont_HeronBook&#39;)"><span class="icon">Toggle Font Controls</span></a></li><li class="dropdown sharing-controls"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#" class="trigger" data-push-state="false" title="Share" aria-label="Share" onclick="window.Appcues.track(&#39;Share_HeronBook&#39;)"><i class="fa fa-share"></i></a><ul class="social-sharing dropdown-menu"><li><a class="twitter share-button t-twitter" target="_blank" aria-label="Share this section on Twitter" title="Share this section on Twitter" href="https://twitter.com/share?url=https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_11_Chapter.xhtml&amp;text=Practical%20Microservices%20Architectural%20Patterns%3A%20Event-Based%20Java%20Microservices%20with%20Spring%20Boot%20and%20Spring%20Cloud&amp;via=OReillyMedia"><span>Twitter</span></a></li><li><a class="facebook share-button t-facebook" target="_blank" aria-label="Share this section on Facebook" title="Share this section on Facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_11_Chapter.xhtml"><span>Facebook</span></a></li><li><a class="googleplus share-button t-googleplus" target="_blank" aria-label="Share this secton on Google Plus" title="Share this secton on Google Plus" href="https://plus.google.com/share?url=https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_11_Chapter.xhtml"><span>Google Plus</span></a></li><li><a class="email share-button t-email" aria-label="Share this section via email" title="Share this section via email" href="mailto:?subject=Safari:%2011.%C2%A0Events%2C%20Eventuality%2C%20and%20Consistency&amp;body=https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_11_Chapter.xhtml%0D%0Afrom%20Practical%20Microservices%20Architectural%20Patterns%3A%20Event-Based%20Java%20Microservices%20with%20Spring%20Boot%20and%20Spring%20Cloud%0D%0A"><span>Email</span></a></li></ul></li><!-- endif request.user.is_authenticated -->
      </ul>
    </div>

      
          
      

    <section role="document"><script src="./10. Microservice Performance - Practical Microservices Architectural Patterns_ Event-Based Java Microservices with Spring Boot and Spring Cloud_files/48743.js.下载"></script>
<script>
  var userId = "6d9ee17b-34b1-4bf4-bdae-19676bd84ca1";

  var userObject = {
    firstName: "Feng",
    segment: "B2B",
    admin: "False",
    profileCreatedOn: "2019-03-11",
    academic: "false"
  };
  window.Appcues.identify(userId, userObject);
  window.Appcues.page();

  setTimeout(function () {
    window.Appcues.track('ViewingBook_HeronBook')
  }, 20000);
</script>


	  <div class="t-sbo-prev sbo-prev sbo-nav-top">
  
    
      
        <a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_9_Chapter.xhtml" class="prev nav-link">
      
          <span aria-hidden="true" class="pagination-label t-prev-label">Prev</span>
          <span class="visuallyhidden">Previous Chapter</span>
          <div class="pagination-title t-prev-title">9.&nbsp;High Availability and Microservices</div>
        </a>
    
  
  </div>

  <div class="t-sbo-next sbo-next sbo-nav-top">
  
    
      
        <a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_11_Chapter.xhtml" class="next nav-link">
      
          <span aria-hidden="true" class="pagination-label t-next-label">Next</span>
          <span class="visuallyhidden">Next Chapter</span>
          <div class="pagination-title t-next-title">11.&nbsp;Events, Eventuality, and Consistency</div>
        </a>
    
  
  </div>



<div id="sbo-rt-content"><div class="annotator-wrapper"><div class="ChapterContextInformation"><div class="ContextInformation" id="b978-1-4842-4501-9_10"><div class="ChapterCopyright">©&nbsp;Binildas Christudas&nbsp;2019</div><span class="ContextInformationAuthorEditorNames"><span class="Author"><span class="AuthorName">Binildas&nbsp;Christudas</span></span></span><span class="ContextInformationBookTitles"><span class="BookTitle" epub:type="title" lang="en">Practical Microservices Architectural Patterns</span></span><span class="ChapterDOI"><a href="https://doi.org/10.1007/978-1-4842-4501-9_10">https://doi.org/10.1007/978-1-4842-4501-9_10</a></span></div></div><!--Begin Abstract--><div class="MainTitleSection"><h1 class="ChapterTitle" lang="en">10.&nbsp;Microservice Performance</h1></div><div class="AuthorGroup"><div class="AuthorNames"><span class="Author"><span class="AuthorName">Binildas&nbsp;Christudas</span><sup><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#Aff2" class="totri-footnote">1</a>&nbsp;<span class="ContactIcon"></span></sup></span></div><div class="Affiliations"><div class="Affiliation" id="Aff2"><span class="AffiliationNumber">(1)</span><div class="AffiliationText">Trivandrum, Kerala, India</div></div><div class="ClearBoth">&nbsp;</div></div></div><!--End Abstract--><div class="Fulltext"><div class="Para" id="Par2">When you move from the traditional three-tier or n-tier architecture to the microservices architecture, one main observable characteristic is the increased number of interconnections between microservice processes. A computation that once took place completely within a single process now might get split into many microcomputations spanning across processes. This increases the number of interprocess communications, the number of context switches, the number of I/O operations involved, and so on. So it makes right sense to have a look at these aspects in more detail. In this chapter, you will explore a few performance aspects to be considered in microservices and you will look into the following:<div class="UnorderedList"><ul class="UnorderedListMarkBullet"><li><p class="Para" id="Par3">Synchronous vs. asynchronous HTTP</p></li><li><p class="Para" id="Par4">The Servlet 3.0 spec for asynchronous HTTP</p></li><li><p class="Para" id="Par5">Code to demonstrate asynchronous HTTP between browser and microservice</p></li><li><p class="Para" id="Par6">Code to demonstrate asynchronous HTTP between microservices</p></li><li><p class="Para" id="Par7">The Google Protocol Buffer</p></li><li><p class="Para" id="Par8">Code to demonstrate using the Google Protocol Buffer between microservices</p></li></ul></div></div><section class="Section1 RenderAsSection1" id="Sec1"><h2 class="Heading">Communication Across the Outer Architecture</h2><div class="Para" id="Par9">The “Outer Architecture Perspective” section in Chapter <span class="ExternalRef"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_4_Chapter.xhtml" class="totri-footnote"><span class="RefSource">4</span></a></span> introduced the outer <span id="ITerm1">architecture</span> of microservices. There you saw how the internal complexities of a typical monolith architecture pop out to the “surface” when you move to a microservices-based architecture. One obvious change is the split of a single or a few computational processes into many more similar, but smaller computationally intensive processes. This change is better explained with the help of Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#Fig1">10-1</a></span>.<figure class="Figure" id="Fig1"><div class="MediaObject" id="MO1"><img alt="../images/477630_1_En_10_Chapter/477630_1_En_10_Fig1_HTML.jpg" src="./10. Microservice Performance - Practical Microservices Architectural Patterns_ Event-Based Java Microservices with Spring Boot and Spring Cloud_files/477630_1_En_10_F.jpg" style="height:24.72em" width="1725" height="989" data-mfp-src="/library/view/practical-microservices-architectural/9781484245019/images/477630_1_En_10_Chapter/477630_1_En_10_Fig1_HTML.jpg"></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 10-1</span><p class="SimplePara">Monolith vs. <span id="ITerm2">microservices</span> boundaries</p></div></figcaption></figure></div><p class="Para" id="Par10">In the traditional monolith, the multiple components that form the building blocks of a service realization get executed in a single container process. Method invocations or messaging between these components are “local” or “in process.” This will allow processes, whether a container-managed process or a simple Java application process, to make a lot of assumptions and optimizations and complete the execution. However, when you rearchitect the same service from the monolith into the microservices <span id="ITerm3">architecture</span>, the implementation gets split and deployed into more than one process. This is shown in Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#Fig1">10-1</a></span>.</p><p class="Para" id="Par11">Interprocess communications are heavyweight compared to communications within a process. They involve more context switches, network wait and I/O operations, data marshalling and unmarshalling, etc. This increases the complexity involved in the outer architecture space of a microservices architecture.</p><p class="Para" id="Par12">Further, every microservice involves socket listeners listening to incoming traffic. So, compared to a traditional monolith, microservices architecture involves many more socket listeners, associated threads to process incoming traffic, and so on. A look into the details of a few of these handpicked concerns and analyzing the options to address them will give you a fair enough idea of the whole <span id="ITerm4">landscape</span>.</p></section><section class="Section1 RenderAsSection1" id="Sec2"><h2 class="Heading">Asynchronous HTTP</h2><p class="Para" id="Par13">You briefly looked at distributed messaging in Chapter <span class="ExternalRef"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_6_Chapter.xhtml" class="totri-footnote"><span class="RefSource">6</span></a></span>, where you also appreciated the differences between the synchronous and asynchronous style of communications between microservices. You saw that messaging is a first-class technology by which microservices can communicate <span id="ITerm5">asynchronously</span>, and you saw via examples how you can correlate many asynchronous message transmissions so as to weave them together as pieces of a single, end-to-end request/response cycle. However, all of the samples in Chapter <span class="ExternalRef"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_8_Chapter.xhtml" class="totri-footnote"><span class="RefSource">8</span></a></span> used the HTTP protocol for intercommunications between microservices. You will look at the nature of these communications more closely in this section.</p><section class="Section2 RenderAsSection2" id="Sec3"><h3 class="Heading">The Bad and the&nbsp;Ugly Part of HTTP</h3><p class="Para" id="Par14">As stated, all of the samples in Chapter <span class="ExternalRef"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_8_Chapter.xhtml" class="totri-footnote"><span class="RefSource">8</span></a></span> use the HTTP protocol for intercommunications between microservices. If you examine these interactions again, you can observe that most of them are synchronous HTTP calls. Close observation of these communications reveals that an incoming request from a consumer microservice to your provider microservice server will capture one <span id="ITerm6">servlet connection</span> and perform a blocking call to the remote service before it can send a response to the consumer microservice. It works, but it does not scale effectively if you have many such concurrent clients. <span id="ITerm7">Synchronous HTTP</span> is a best fit for a user using a client application to get instant feedback or a response; however, that is not the case when it comes to server-side processing.</p></section><section class="Section2 RenderAsSection2" id="Sec4"><h3 class="Heading">APIs for Asynchronous HTTP Processing</h3><p class="Para" id="Par15">Typical containers in application servers like in Apache Tomcat normally use a <span id="ITerm8">server thread</span> per client request. Under increased load conditions, this necessitates containers to have a large amount of threads to serve all the client requests. This limits <span id="ITerm9">scalability</span>, which can arise due to running out of memory or exhausting the pool of container threads. Java EE has added asynchronous processing support for <span id="ITerm10">servlets and filters</span> from the Servlet 3.0 spec onwards. A servlet or a filter, on reaching a potentially blocking operation when processing a request, can assign the operation to an asynchronous execution context and return the <span id="ITerm11">thread</span> associated with the request immediately to the container without waiting to generate a response. The blocking operation can later complete in the asynchronous execution context in some different thread, which can generate a response or dispatch the request to another servlet. The <span class="EmphasisFontCategoryNonProportional ">javax.servlet.AsyncContext</span><span id="ITerm12">
                
              </span> class is the API that provides the functionality that you need to perform asynchronous processing inside service methods. The <span class="EmphasisFontCategoryNonProportional ">startAsync()</span> method<span id="ITerm13">
                
              </span> on the <span class="EmphasisFontCategoryNonProportional ">HttpServletRequest</span> object of your service method puts the request into asynchronous mode and ensures that the response is not committed even after exiting the service method. You have to generate the response in the asynchronous context after the blocking operation completes or dispatch the request to another servlet.</p><div class="Para" id="Par16">The programming model is straightforward. Let’s try to understand the difference by first looking at the pseudo code for the traditional programming model of a <span class="EmphasisFontCategoryNonProportional ">Controller</span> class. See Listing <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#PC1">10-1</a></span>.<div class="ProgramCode" id="PC1"><div class="LineGroup"><div class="FixedLine">@RestController</div><div class="FixedLine">public class ProductRestController{</div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;@RequestMapping(value = "/products", method = RequestMethod.GET ,</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;produces = {MediaType.APPLICATION_JSON_VALUE})</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;public List&lt;Product&gt; getAllProducts() {</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//return "List of All Products";</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;}</div><div class="FixedLine">}</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 10-1</span><p class="SimplePara">Pseudo Code for a Sync Controller</p></div></div></div></div><div class="Para" id="Par17">When you use Spring, the controller method can return a <span id="ITerm14">
                <span class="EmphasisFontCategoryNonProportional ">java.util.concurrent.Callable</span>
                
              </span> to complete processing asynchronously. <span id="ITerm15">Spring MVC</span> will then invoke the <span id="ITerm16">
                <span class="EmphasisFontCategoryNonProportional ">Callable</span>
                
                
                
              </span> in a separate thread with the help of a TaskExecutor. A <span id="ITerm17">TaskExecutor</span> is Spring’s abstraction for asynchronous execution and scheduling of tasks. The rewritten pseudo code is shown in Listing <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#PC2">10-2</a></span>.<div class="ProgramCode" id="PC2"><div class="LineGroup"><div class="FixedLine">@RestController</div><div class="FixedLine">public class ProductRestController{</div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;@RequestMapping(value = "/products", method = RequestMethod.GET ,</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;produces = {MediaType.APPLICATION_JSON_VALUE})</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;public Callable&lt;List&lt;Product&gt;&gt; getAllProducts() {</div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return new Callable&lt;List&lt;Product&gt;&gt;() {</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public Object call() throws Exception {</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// ...</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// return "List of All Products";</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;}</div><div class="FixedLine">}</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 10-2</span><p class="SimplePara">Pseudo Code for an Async Controller Using <span id="ITerm18">Callable</span></p></div></div></div></div><p class="Para" id="Par18">Spring<span id="ITerm19">
                
                
                
              </span> 3.2 introduced <span class="EmphasisFontCategoryNonProportional ">org.springframework.web.context.request.async.DeferredResult</span>, which can again be returned by a <span class="EmphasisFontCategoryNonProportional ">Controller</span> class. <span class="EmphasisFontCategoryNonProportional ">DeferredResult</span> provides an alternative to using a <span id="ITerm20">
                <span class="EmphasisFontCategoryNonProportional ">Callable</span>
                
                
                
              </span> for asynchronous request processing. While a <span class="EmphasisFontCategoryNonProportional ">Callable</span> is executed concurrently on behalf of the application, with a <span class="EmphasisFontCategoryNonProportional ">DeferredResult</span> the application can produce the result from a thread of its choice. Here, the processing can happen in a thread not known to Spring MVC, similar to the case when you need to get a response from a messaging channel, and so on. So, when you use <span class="EmphasisFontCategoryNonProportional ">DeferredResult</span>, even after you leave the controller handler method, the request processing is not done. Instead, Spring MVC (using Servlet 3.0 capabilities) will hold on with the response, keeping the idle HTTP connection. Even though the HTTP Worker Thread is no longer used, the HTTP connection is still open. At a later point in time, some other thread will resolve <span class="EmphasisFontCategoryNonProportional ">DeferredResult</span> by assigning some value to it. <span id="ITerm21">Spring MVC</span> will immediately pick up this event and send a response to the client, finishing the request processing.</p><div class="Para" id="Par19">The pseudo code for an async scenario using <span id="ITerm22">
                <span class="EmphasisFontCategoryNonProportional ">DeferredResult</span>
                
                
                
              </span> is shown in Listing <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#PC3">10-3</a></span>.<div class="ProgramCode" id="PC3"><div class="LineGroup"><div class="FixedLine">@RestController</div><div class="FixedLine">public class ProductRestController{</div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;@RequestMapping(value = "/products", method = RequestMethod.GET ,</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;produces = {MediaType.APPLICATION_JSON_VALUE})</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;public DeferredResult&lt;List&lt;Product&gt;&gt; getAllProducts() {</div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DeferredResult&lt;List&lt;Product&gt;&gt; deferredResult =</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new DeferredResult&lt;List&lt;Product&gt;&gt; ();</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Add deferredResult to an internal memory holder</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// like a Queue or a Map...</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return deferredResult;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;}<span id="ITerm23">
                      
                      
                      
                    </span></div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;// In some other thread...</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;deferredResult.setResult(data);</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;// Remove deferredResult from the internal memory holder</div><div class="FixedLine">}</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 10-3</span><p class="SimplePara">Pseudo Code for an Async Controller Using <span id="ITerm24">DeferredResult</span></p></div></div></div></div><div class="Para" id="Par20">Java 8 introduced <span class="EmphasisFontCategoryNonProportional ">java.util.concurrent.</span><span id="ITerm25">
                <span class="EmphasisFontCategoryNonProportional ">CompletableFuture</span>
                
                
                
              </span>, which can be used with Spring to create async endpoints that similarly free up request threads to perform other tasks. In this case, the <span class="EmphasisFontCategoryNonProportional ">DeferredResult.setResult</span> may simply be replaced with <span class="EmphasisFontCategoryNonProportional ">CompletableFuture.complete</span>. A <span class="EmphasisFontCategoryNonProportional ">CompletableFuture</span> is a <span id="ITerm26">
                <span class="EmphasisFontCategoryNonProportional ">java.util.concurrent.Future</span>
                
              </span><span class="EmphasisFontCategoryNonProportional ">.</span> A <span class="EmphasisFontCategoryNonProportional ">Future</span> represents the result of an asynchronous computation whereas a <span class="EmphasisFontCategoryNonProportional ">CompletableFuture</span> is a <span class="EmphasisFontCategoryNonProportional ">Future</span> that may be explicitly completed (setting its value and status) and may be used as a <span class="EmphasisFontCategoryNonProportional ">CompletionStage</span>, supporting dependent functions and actions that trigger upon its completion. <span class="EmphasisFontCategoryNonProportional ">CompletableFuture</span> makes handling complex asynchronous programming easier. It even lets you combine and cascade async calls, and also offers the static utility methods <span class="EmphasisFontCategoryNonProportional ">runAsync</span><span id="ITerm27">
                
              </span> and <span class="EmphasisFontCategoryNonProportional ">supplyAsync</span><span id="ITerm28">
                
              </span> to abstract away the manual creation of threads. See Listing <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#PC4">10-4</a></span>.<div class="ProgramCode" id="PC4"><div class="LineGroup"><div class="FixedLine">@RestController</div><div class="FixedLine">public class ProductRestController{</div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;@RequestMapping(value = "/products", method = RequestMethod.GET,</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;produces = {MediaType.APPLICATION_JSON_VALUE})</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;public CompletableFuture&lt;List&lt;Product&gt;&gt; getAllProducts() {</div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Future&lt;List&lt;Product&gt;&gt; future =</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new CompletableFuture&lt;List&lt;Product&gt;&gt;();</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return CompletableFuture.supplyAsync(() -&gt; "in the background");</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;}<span id="ITerm29">
                      
                      
                      
                    </span></div><div class="FixedLine">}</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 10-4</span><p class="SimplePara">Pseudo Code for an Async Controller using <span id="ITerm30">CompletableFuture</span></p></div></div></div></div></section><section class="Section2 RenderAsSection2" id="Sec5"><h3 class="Heading">Design a Scenario to Demo Async HTTP Between Microservices</h3><p class="Para" id="Par21">You will use a trimmed down version of the same components used for previous <span id="ITerm31">examples</span>. So your sample here will consist of three main components: an HTML-based client app and two microservices, as shown in Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#Fig2">10-2</a></span>. I have removed all complexities of HATEOAS and any data repositories so that you can concentrate on async HTTP alone. Once you appreciate the design and the main components used to implement it, then you should be able to use a similar pattern for your other complex business scenarios.</p><div class="Para" id="Par22">In the design shown, the client app communicates with the Product Web microservice using the HTTP protocol; however, you want the client to do it using the async HTTP model. Similarly, the Product Web microservice communicates with the Product Server microservice, again using the HTTP protocol, and this intermicroservices communication is designed using the async HTTP model.<figure class="Figure" id="Fig2"><div class="MediaObject" id="MO2"><img alt="../images/477630_1_En_10_Chapter/477630_1_En_10_Fig2_HTML.jpg" src="./10. Microservice Performance - Practical Microservices Architectural Patterns_ Event-Based Java Microservices with Spring Boot and Spring Cloud_files/477630_1_E(1).jpg" style="height:30.1em" width="1725" height="1204" data-mfp-src="/library/view/practical-microservices-architectural/9781484245019/images/477630_1_En_10_Chapter/477630_1_En_10_Fig2_HTML.jpg"></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 10-2</span><p class="SimplePara">Design an async HTTP scenario in Spring Boot</p></div></figcaption></figure></div><p class="Para" id="Par23">Let’s walk through the <span id="ITerm32">design</span> in more detail by referring to the code snippets so that the concepts will be more clear.</p></section><section class="Section2 RenderAsSection2" id="Sec6"><h3 class="Heading">Code to Use Async HTTP in Spring Boot</h3><div class="Para" id="Par24">All the code samples for this section are in folder <span class="EmphasisFontCategoryNonProportional ">ch10\ch10-01</span>. Visit <span class="EmphasisFontCategoryNonProportional ">pom.xml</span> to see the explicit mention of the <span id="ITerm33">spring-boot-starter-web dependency</span><span id="ITerm34">
                
                
                
              </span> for your Product Server microservice. See Listing <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#PC5">10-5</a></span>.<div class="ProgramCode" id="PC5"><div class="LineGroup"><div class="FixedLine">&lt;dependency&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;</div><div class="FixedLine">&lt;/dependency&gt;</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 10-5</span><p class="SimplePara">Adding spring-boot-starter-web to Spring Boot (ch10\ch10-01\ProductServer\pom.xml)</p></div></div></div></div><p class="Para" id="Par25">spring-boot-starter-web<span id="ITerm35">
                
              </span><span id="ITerm36">
                
                
                
              </span> will add Tomcat and Spring MVC to the Product Server microservice.</p><div class="Para" id="Par26">Next, look at the <span id="ITerm37">Boot main application class</span> shown in Listing <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#PC6">10-6</a></span>.<div class="ProgramCode" id="PC6"><div class="LineGroup"><div class="FixedLine">@SpringBootApplication</div><div class="FixedLine">@EnableAsync</div><div class="FixedLine">public class EcomProductMicroserviceApplication {</div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;public static void main(String[] args) {</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SpringApplication.run(EcomProductMicroserviceApplication.class, args);</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;}</div><div class="FixedLine">}</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 10-6</span><p class="SimplePara">Async Enabled Spring Boot Application (ch10\ch10-01\ProductServer\src\main\java\com\acme\ecom\product\EcomProductMicroserviceApplication.java)</p></div></div></div></div><p class="Para" id="Par27">The <span class="EmphasisFontCategoryNonProportional ">@EnableAsync</span> annotation<span id="ITerm38">
                
              </span> switches on Spring’s ability to run <span class="EmphasisFontCategoryNonProportional ">@Async</span> methods<span id="ITerm39">
                
              </span> in a background thread pool. This class also customizes the Executor backing the thread pool. By default, a <span id="ITerm40">SimpleAsyncTaskExecutor</span> is used. The SimpleAsyncTaskExecutor does not reuse threads. Even though it supports limiting concurrent threads through the <span class="EmphasisFontCategoryNonProportional ">concurrencyLimit</span> bean property, by default the number of concurrent threads is unlimited. In serious applications you should consider a thread-pooling <span id="ITerm41">TaskExecutor</span> implementation instead.</p><div class="Para" id="Par28">Next, look at the <span id="ITerm42">Service component</span> where you implement the async processing logic, shown in Listing <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#PC7">10-7</a></span>.<div class="ProgramCode" id="PC7"><div class="LineGroup"><div class="FixedLine">@Service</div><div class="FixedLine">public class ProductService{</div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;@Async</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;public CompletableFuture&lt;List&lt;Product&gt;&gt; getAllProducts()</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throws InterruptedException{</div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List&lt;Product&gt; products = getAllTheProducts();</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (products.size() == 0) {</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGGER.debug("No Products Retreived from the repository");</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGGER.debug(Thread.currentThread().toString());</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Thread.sleep(2000L); // Delay to mock a long running task</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return CompletableFuture.completedFuture(products);</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;}</div><div class="FixedLine">}<span id="ITerm43">
                      
                      
                      
                    </span></div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 10-7</span><p class="SimplePara">Service Component Implementing Async Processing (ch10\ch10-01\ProductServer\src\main\java\com\acme\ecom\product\service\ProductService.java)</p></div></div></div></div><p class="Para" id="Par29">The class is marked with the <span class="EmphasisFontCategoryNonProportional ">@Service</span> annotation<span id="ITerm44">
                
              </span>, making it a candidate for Spring’s component scanning to detect it and add it to the application context. Next, the <span class="EmphasisFontCategoryNonProportional ">getAllProducts</span> method is marked with Spring’s <span class="EmphasisFontCategoryNonProportional ">@Async</span> annotation, indicating it will run on a separate thread. The method’s return type is <span class="EmphasisFontCategoryNonProportional ">CompletableFuture&lt;List&lt;Product&gt;&gt;</span> instead of <span class="EmphasisFontCategoryNonProportional ">&lt;List&lt;Product&gt;&gt;</span>, a requirement for any asynchronous service. This code uses the <span class="EmphasisFontCategoryNonProportional ">completedFuture</span> method to return a <span class="EmphasisFontCategoryNonProportional ">CompletableFuture</span> instance, which is already completed with the collection of results queried from the repository (a processing logic supposed to be taking considerable amount of time to complete).</p><div class="Para" id="Par30">Now, look at the <span id="ITerm45">Rest Controller</span> of the Product Server microservice, shown in Listing <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#PC8">10-8</a></span>.<div class="ProgramCode" id="PC8"><div class="LineGroup"><div class="FixedLine">@RestController</div><div class="FixedLine">public class ProductRestController {</div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;private final ProductService productService;</div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;@Autowired</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;public ProductRestController(ProductService productService) {</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.productService = productService;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;}</div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;@RequestMapping(value = "/products", method = RequestMethod.GET,</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;produces = {MediaType.APPLICATION_JSON_VALUE})</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;public CompletableFuture&lt;List&lt;Product&gt;&gt; getAllProducts()</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throws InterruptedException, ExecutionException{</div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGGER.debug(Thread.currentThread().toString());</div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return productService.getAllProducts()</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.thenApply(products -&gt; {</div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;products.forEach(item-&gt;LOGGER.debug(item.toString()));</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGGER.debug(Thread.currentThread().toString());</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return products;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;}<span id="ITerm46">
                      
                      
                      
                    </span></div><div class="FixedLine">}</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 10-8</span><p class="SimplePara">Product Server Rest Controller Facilitating Async (ch10\ch10-01\ProductServer\src\main\java\com\acme\ecom\product\controller\ProductRestController.java)</p></div></div></div></div><p class="Para" id="Par31">Note that the <span class="EmphasisFontCategoryNonProportional ">CompletableFuture</span> response returned by <span class="EmphasisFontCategoryNonProportional ">productService.getAllProducts()</span> allows you to manually control the moment when the future returns and also transform the output in the process. You then convert this simple <span class="EmphasisFontCategoryNonProportional ">CompletableFuture</span> into the format you need with the help of <span class="EmphasisFontCategoryNonProportional ">thenApply()</span><span id="ITerm47">
                
              </span>, which allows you to log some data about the current thread to make sure that the execution really happens asynchronously, that is, the thread that is finishing the work is not the thread that started the work. The Rest Controller too then returns the collection of the products once again as another <span class="EmphasisFontCategoryNonProportional ">CompletableFuture&lt;List&lt;Product&gt;&gt;</span> so that <span id="ITerm48">Spring MVC</span> will also act to execute the HTTP method in an async manner, making it a smartly implemented microservice! Keep in mind that this is an independent microservice; you will next look at a dependent microservice that depends on this independent microservice (as is shown in the design).</p><div class="Para" id="Par32">The dependent microservice is the Product Web microservice. The main code lies in the <span class="EmphasisFontCategoryNonProportional ">Controller</span> class<span id="ITerm49">
                
                
                
              </span>, shown in Listing <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#PC9">10-9</a></span>.<div class="ProgramCode" id="PC9"><div class="LineGroup"><div class="FixedLine">@RestController</div><div class="FixedLine">public class ProductRestController{</div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;private final AsyncRestTemplate asyncRestTemplate =</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new AsyncRestTemplate();</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;private static String PRODUCT_SERVICE_URL =</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"http://localhost:8080/products/";</div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;@RequestMapping(value = "/productsweb", method = RequestMethod.GET,</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;produces = {MediaType.APPLICATION_JSON_VALUE})</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;public DeferredResult&lt;List&lt;Product&gt;&gt; getAllProducts() {</div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGGER.debug(Thread.currentThread().toString());</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DeferredResult&lt;List&lt;Product&gt;&gt; deferredResult = new DeferredResult&lt;&gt;();</div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ParameterizedTypeReference&lt;List&lt;Product&gt;&gt; responseTypeRef =</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new ParameterizedTypeReference&lt;List&lt;Product&gt;&gt;() {};</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ListenableFuture&lt;ResponseEntity&lt;List&lt;Product&gt;&gt;&gt; entity =</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;asyncRestTemplate.exchange(PRODUCT_SERVICE_URL,</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HttpMethod.GET, (HttpEntity&lt;Product&gt;) null, responseTypeRef);</div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entity.addCallback(new<span id="ITerm50">
                      
                      
                      
                    </span></div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ListenableFutureCallback&lt;ResponseEntity&lt;List&lt;Product&gt;&gt;&gt;() {</div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public void onFailure(Throwable ex) {</div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGGER.debug(Thread.currentThread().toString());</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGGER.error(ex.getMessage());</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@Override</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public void onSuccess(ResponseEntity&lt;List&lt;Product&gt;&gt; result) {</div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List&lt;Product&gt; products = result.getBody();</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;products.forEach(item-&gt;LOGGER.debug(item.toString()));</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGGER.debug(Thread.currentThread().toString());</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;deferredResult.setResult(products);</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});</div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGGER.debug(Thread.currentThread().toString());</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return deferredResult;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;}</div><div class="FixedLine">}</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 10-9</span><p class="SimplePara">Microservice Calling Async HTTP on Another Microservice (ch10\ch10-01\ProductWeb\src\main\java\com\acme\ecom\product\controller\ProductRestController.java)</p></div></div></div></div><p class="Para" id="Par33">The <span class="EmphasisFontCategoryNonProportional ">PRODUCT_SERVICE_URL</span> here refers to the independent microservice. The Product Web microservice has to invoke the Product Server microservice. You have already made the Product Server microservice methods asynchronous. Let’s now make the Product Web microservice method asynchronous too so that all the containers hosting these microservices can better utilize container resources by implementing asynchronous characteristics to the runtime model. You are not done; you want to invoke the Product Server microservice too in an asynchronous mode so that both the microservice implementations as well as the intermicroservices communications are in smart, asynchronous mode!</p><p class="Para" id="Par34"><span class="EmphasisFontCategoryNonProportional ">org.springframework.web.client.AsyncRestTemplate</span><span id="ITerm51">
                
                
                
              </span> is Spring’s central class for asynchronous client-side HTTP access. It exposes methods similar to those of RestTemplate; however, it returns ListenableFuture wrappers as opposed to concrete results. By default, AsyncRestTemplate relies on standard JDK facilities to establish HTTP connections. Here again you can switch to a different HTTP library such as Apache HttpComponents, Netty, or OkHttp by using a constructor accepting an AsyncClientHttpRequestFactory. The AsyncRestTemplate gives you a <span id="ITerm52">
                <span class="EmphasisFontCategoryNonProportional ">ListenableFuture</span>
                
                
                
              </span><span class="EmphasisFontCategoryNonProportional ">,</span> so the container thread will not wait for the response to be received back; instead it will continue with the next steps of processing since you are using AsyncRestTemplate. <span class="EmphasisFontCategoryNonProportional ">ListenableFuture</span> has the capability to accept completion callbacks, so you add callbacks on failure and success scenarios. If success, you set the result to the body of the <span id="ITerm53">
                <span class="EmphasisFontCategoryNonProportional ">DeferredResult</span>
                
                
                
              </span><span class="EmphasisFontCategoryNonProportional ">.</span> Since the Spring MVC is holding on to the response through the idle HTTP connection, as soon as you set the result to the <span class="EmphasisFontCategoryNonProportional ">DeferredResult</span>, the client will receive it.</p><div class="Para" id="Par35"><span class="EmphasisFontCategoryNonProportional ">product_service.js</span> has the code that the <span id="ITerm54">Angular JS client</span> will use to invoke the Product Web microservice; see Listing <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#PC10">10-10</a></span>.<div class="ProgramCode" id="PC10"><div class="LineGroup"><div class="FixedLine">App.factory('ProductService', ['$http', '$q', function($http, $q){</div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;return {</div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;getApplication: function() {</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $http.get('http://localhost:8081/productsweb/')</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.then(</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function(response){</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return response.data;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function(errResponse){</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;console.error('Error while fetching application');</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $q.reject(errResponse);</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<span id="ITerm55">
                      
                      
                      
                    </span></div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;};</div></div><div class="LineGroup"><div class="FixedLine">}]);</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 10-10</span><p class="SimplePara">Web Client Invoking Async HTTP (ch10\ch10-01\ProductWeb\src\main\resources\static\js\service\product_service.js)</p></div></div></div></div></section><section class="Section2 RenderAsSection2" id="Sec7"><h3 class="Heading">Build and Test Asynchronous HTTP Between Microservices</h3><p class="Para" id="Par36">The complete code required to demonstrate asynchronous HTTP between microservices is in folder <span class="EmphasisFontCategoryNonProportional ">ch10\ch10-01</span>. You don’t require MongoDB for this sample. You can build, pack, and run the different microservices in the following order.</p><div class="Para" id="Par37">Bring up the Product Server microservice first:<div class="ProgramCode" id="PC11"><div class="LineGroup"><div class="FixedLine">cd ch10\ch10-01\ProductServer</div><div class="FixedLine">D:\binil\gold\pack03\ch10\ch10-01\ProductServer&gt;make</div><div class="FixedLine">D:\binil\gold\pack03\ch10\ch10-01\ProductServer&gt;mvn -Dmaven.test.skip=true clean package</div><div class="FixedLine">D:\binil\gold\pack03\ch10\ch10-01\ProductServer&gt;run</div><div class="FixedLine">D:\binil\gold\pack03\ch10\ch10-01\ProductServer&gt;java -jar -Dserver.port=8080 .\target\Ecom-Product-Microservice-0.0.1-SNAPSHOT.jar</div></div></div></div><p class="Para" id="Par38">Refer to Appendix D to get an overview of <span id="ITerm56">cURL and Postman</span>. You can use any of these tools to test the above microservice by pointing to <span class="EmphasisFontCategoryNonProportional ">http://localhost:8080/products/</span>.</p><div class="Para" id="Par39">Next, bring up the Product Web microservice:<div class="ProgramCode" id="PC12"><div class="LineGroup"><div class="FixedLine">cd ch10\ch10-01\ProductWeb</div><div class="FixedLine">D:\binil\gold\pack03\ch10\ch10-01\ProductWeb&gt;make</div><div class="FixedLine">D:\binil\gold\pack03\ch10\ch10-01\ProductWeb&gt;mvn -Dmaven.test.skip=true clean package</div><div class="FixedLine">D:\binil\gold\pack03\ch10\ch10-01\ProductWeb&gt;run</div><div class="FixedLine">D:\binil\gold\pack03\ch10\ch10-01\ProductWeb&gt;java -jar -Dserver.port=8081 .\target\Ecom-Product-Microservice-0.0.1-SNAPSHOT.jar</div></div></div></div><p class="Para" id="Par40">You can again use cURL or Postman to test the Product Web microservice pointing to <span class="EmphasisFontCategoryNonProportional ">http://localhost:8081/productsweb/</span>.</p><div class="Para" id="Par41">Alternatively, you may open this HTML utility preferably in the Chrome browser:<div class="ProgramCode" id="PC13"><div class="LineGroup"><div class="FixedLine">ch10\ch10-01\ProductWeb\src\main\resources\product.html.</div></div></div></div><p class="Para" id="Par42">Upon loading itself, the browser client will fire a request to Product Web, listening on port 8081, which will delegate the request to the Product Server microservice listening on port 8080. All is good until now, as far as the request routes are concerned. In fact, the HTTP conduit between the client and the Product Web microservice as well as the one between the Product Web microservice and the Product Server microservice are kept open and idle, and the container threads in both the microservices will return to be available for context switching. So, your Postman client or the HTML utility client will keep waiting over the idle HTTP connection. On the server side, processing happens in different threads and as soon as the results are available, they are written back to the open HTTP connection.</p><div class="Para" id="Par43">The <span id="ITerm57">thread dynamics</span> can be understood by carefully observing the logs of the microservices consoles. Listing <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#PC14">10-11</a></span> shows the <span id="ITerm58">console</span> output for the called (ProductServer) microservice.<div class="ProgramCode" id="PC14"><div class="LineGroup"><div class="FixedLine">D:\binil\gold\pack03\ch10\ch10-01\ProductServer&gt;run</div></div><div class="LineGroup"><div class="FixedLine">D:\binil\gold\pack03\ch10\ch10-01\ProductServer&gt;java -jar -Dserver.port=8080 .\target\Ecom-Product-Microservice-0.0.1-SNAPSHOT.jar</div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;.&nbsp;&nbsp;&nbsp;____&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__ _ _</div><div class="FixedLine">&nbsp;/\\ / ___'_ __ _ _(_)_ __&nbsp;&nbsp;__ _ \ \ \ \</div><div class="FixedLine">( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \</div><div class="FixedLine">&nbsp;\\/&nbsp;&nbsp;___)| |_)| | | | | || (_| |&nbsp;&nbsp;) ) ) )</div><div class="FixedLine">&nbsp;&nbsp;'&nbsp;&nbsp;|____| .__|_| |_|_| |_\__, | / / / /</div><div class="FixedLine">&nbsp;=========|_|==============|___/=/_/_/_/</div><div class="FixedLine">&nbsp;:: Spring Boot ::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(v1.5.4.RELEASE)</div></div><div class="LineGroup"><div class="FixedLine">2019-02-23 10:11:33 INFO&nbsp;&nbsp;StartupInfoLogger.logStarting:48 - Starting</div><div class="FixedLine">2019-02-23 10:11:40 INFO&nbsp;&nbsp;StartupInfoLogger.logStarted:57 - Started EcomProductMicroserviceApplication in 8.231 seconds (JVM running for 9.827)</div><div class="FixedLine">2019-02-23 10:13:34 INFO&nbsp;&nbsp;ProductRestController.getAllProducts:94 - Start</div><div class="FixedLine">2019-02-23 10:13:34 DEBUG ProductRestController.getAllProducts:95 - <strong class="EmphasisTypeBold ">Thread[http-nio-8080-exec-10,5,main]</strong></div><div class="FixedLine">2019-02-23 10:13:34 INFO&nbsp;&nbsp;ProductService.getAllProducts:78 - Start</div><div class="FixedLine">2019-02-23 10:13:34 DEBUG ProductService.getAllProducts:79 - Fetching all the products from the repository</div><div class="FixedLine">2019-02-23 10:13:34 INFO&nbsp;&nbsp;ProductService.getAllTheProducts:109 - Start</div><div class="FixedLine">2019-02-23 10:13:34 INFO&nbsp;&nbsp;ProductService.getAllTheProducts:136 - Ending...</div><div class="FixedLine">2019-02-23 10:13:34 DEBUG ProductService.getAllProducts:86 - <strong class="EmphasisTypeBold ">Thread[SimpleAsyncTaskExecutor-1,5,main]</strong></div><div class="FixedLine">2019-02-23 10:13:34 INFO&nbsp;&nbsp;ProductService.getAllProducts:87 - Ending</div><div class="FixedLine">2019-02-23 10:13:36 DEBUG ProductRestController.lambda$null$1:100 - Product [productId=1, ...]<span id="ITerm59">
                      
                      
                      
                    </span></div><div class="FixedLine">2019-02-23 10:13:36 DEBUG ProductRestController.lambda$null$1:100 - Product [productId=2, ...]</div><div class="FixedLine">2019-02-23 10:13:36 DEBUG ProductRestController.lambda$getAllProducts$2:101 - <strong class="EmphasisTypeBold ">Thread[SimpleAsyncTaskExecutor-1,5,main]</strong></div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 10-11</span><p class="SimplePara">Console Log of ProductServer (Called) Microservice</p></div></div></div></div><div class="Para" id="Par44">Listing <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#PC14">10-11</a></span> shows that <span class="EmphasisFontCategoryNonProportional ">ProductRestController</span> gets executed in the context of <span class="EmphasisFontCategoryNonProportional ">Thread[http-nio-8080-exec-10,5,main]</span> and so is the case with&nbsp;&nbsp;<span class="EmphasisFontCategoryNonProportional ">ProductService</span>. In <span class="EmphasisFontCategoryNonProportional ">ProductService</span>, just after the <span class="EmphasisFontCategoryNonProportional ">ProductService.getAllTheProducts:136 - Ending...</span> log has happened, the following two lines of code release the executing thread:<div class="ProgramCode" id="PC15"><div class="LineGroup"><div class="FixedLine">Thread.sleep(2000L); // Delay to mock a long running task</div><div class="FixedLine">return CompletableFuture.completedFuture(products);</div></div></div></div><div class="Para" id="Par45">You need to differentiate between the above two lines of code, and I will explain them:<div class="OrderedList"><ol><li class="ListItem"><span class="ItemNumber">1.</span><div class="ItemContent"><div class="Para" id="Par46">The first line just makes a delay so that the caller (line of code from <span id="ITerm60">
                        <span class="EmphasisFontCategoryNonProportional ">ProductRestController</span>
                        
                        
                        
                      </span> of the ProductWeb microservice reproduced below) will feel a perceived delay from the called microservice:<div class="ProgramCode" id="PC16"><div class="LineGroup"><div class="FixedLine">ListenableFuture&lt;ResponseEntity&lt;List&lt;Product&gt;&gt;&gt; entity =</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;asyncRestTemplate.exchange(PRODUCT_SERVICE_URL, HttpMethod.GET,</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;(HttpEntity&lt;Product&gt;) null, responseTypeRef);</div></div></div></div></div><div class="ClearBoth">&nbsp;</div></li><li class="ListItem"><span class="ItemNumber">2.</span><div class="ItemContent"><p class="Para" id="Par47">The second line of code actually returns the executing thread, so <span class="EmphasisFontCategoryNonProportional ">Thread[http-nio-8080-exec-10,5,main]</span> will be returned back to the embedded web container’s HTTP pool.</p></div><div class="ClearBoth">&nbsp;</div></li></ol></div></div><p class="Para" id="Par48">Later when <span class="EmphasisFontCategoryNonProportional ">CompletableFuture.completedFuture(products)</span> resumes, it will get executed in some other thread context (<span class="EmphasisFontCategoryNonProportional ">Thread[SimpleAsyncTaskExecutor-1,5,main]</span> in your case, as shown in Listing <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#PC14">10-11</a></span>).</p><div class="Para" id="Par49">Similarly, Listing <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#PC17">10-12</a></span> shows the console output for the called (ProductServer) microservice.<div class="ProgramCode" id="PC17"><div class="LineGroup"><div class="FixedLine">D:\binil\gold\pack03\ch10\ch10-01\ProductWeb&gt;run</div></div><div class="LineGroup"><div class="FixedLine">D:\binil\gold\pack03\ch10\ch10-01\ProductWeb&gt;java -jar -Dserver.port=8081 .\target\Ecom-Product-Microservice-0.0.1-SNAPSHOT.jar</div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;.&nbsp;&nbsp;&nbsp;____&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__ _ _</div><div class="FixedLine">&nbsp;/\\ / ___'_ __ _ _(_)_ __&nbsp;&nbsp;__ _ \ \ \ \</div><div class="FixedLine">( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \</div><div class="FixedLine">&nbsp;\\/&nbsp;&nbsp;___)| |_)| | | | | || (_| |&nbsp;&nbsp;) ) ) )</div><div class="FixedLine">&nbsp;&nbsp;'&nbsp;&nbsp;|____| .__|_| |_|_| |_\__, | / / / /</div><div class="FixedLine">&nbsp;=========|_|==============|___/=/_/_/_/</div><div class="FixedLine">&nbsp;:: Spring Boot ::&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(v1.5.4.RELEASE)</div></div><div class="LineGroup"><div class="FixedLine">2019-02-23 10:12:33 DEBUG StartupInfoLogger.logStarting:51 - Running with Spring Boot v1.5.4.RELEASE, Spring v4.3.9.RELEASE</div><div class="FixedLine">2019-02-23 10:12:38 INFO&nbsp;&nbsp;StartupInfoLogger.logStarted:57 - Started EcomProductMicroserviceApplication in 6.804 seconds (JVM running for 8.494)</div><div class="FixedLine">2019-02-23 10:13:34 INFO&nbsp;&nbsp;ProductRestController.getAllProducts:87 - Start</div><div class="FixedLine">2019-02-23 10:13:34 DEBUG ProductRestController.getAllProducts:88 - <strong class="EmphasisTypeBold ">Thread[http-nio-8081-exec-7,5,main]</strong></div><div class="FixedLine">2019-02-23 10:13:34 DEBUG ProductRestController.getAllProducts:113 - <strong class="EmphasisTypeBold ">Thread[http-nio-8081-exec-7,5,main]</strong></div><div class="FixedLine">2019-02-23 10:13:37 DEBUG ProductRestController$2.lambda$onSuccess$0:107 - Product [productId=1, ...]<span id="ITerm61">
                      
                      
                      
                    </span></div><div class="FixedLine">2019-02-23 10:13:37 DEBUG ProductRestController$2.lambda$onSuccess$0:107 - Product [productId=2, ...]</div><div class="FixedLine">2019-02-23 10:13:37 DEBUG ProductRestController$2.onSuccess:108 - <strong class="EmphasisTypeBold ">Thread[SimpleAsyncTaskExecutor-1,5,main]</strong></div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 10-12</span><p class="SimplePara"><span id="ITerm62">Console Log</span> of ProductWeb (Caller) Microservice</p></div></div></div></div><p class="Para" id="Par50">Listings <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#PC14">10-11</a></span> and <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#PC17">10-12</a></span> assert that the background processing happens in threads from <span id="ITerm63">
                <span class="EmphasisFontCategoryNonProportional ">SimpleAsyncTaskExecutor</span>
                
                
                
              </span> whereas the container threads of the format <span class="EmphasisFontCategoryNonProportional ">http-nio-*.*</span> have already completed the request part of the transaction and were given back to the pool. This is a powerful way of bridging the synchronous, blocking paradigm of a RESTful interface with the asynchronous, non-blocking processing performed on the server side.</p></section></section><section class="Section1 RenderAsSection1" id="Sec8"><h2 class="Heading">Google Protocol Buffer Between Spring Boot Microservices</h2><p class="Para" id="Par51">The previous section talked about effectively utilizing the microservices’ server resources like HTTP connections and threads. Equally important are the other possible optimizations in intercommunications between microservices. Since microservices are spread across process boundaries, the amount of data sent across microservices matter. This boils down to the marshalling and unmarshalling of data structures across microservices. You will look into this with examples in this section.</p><section class="Section2 RenderAsSection2" id="Sec9"><h3 class="Heading">Protocol Buffer</h3><p class="Para" id="Par52">Protocol buffers are Google’s platform-neutral and language-neutral mechanism for marshalling and unmarshalling structured data. You need to define how you want your data to be structured to use Protocol Buffer, and then you can use generated source code in multiple platforms and languages to easily write and read your structured data to and from a variety of data streams. One benefit of using Protocol Buffer is that you can even update your data structure without breaking already deployed application code that is compiled against the “old” format. This is especially important in architecting applications capable of adapting or evolving to future requirement changes.</p><div class="Para" id="Par53">You will now look into the dynamics of using Protocol Buffer. You first need to specify how you want the information you’re serializing to be structured in <span class="EmphasisFontCategoryNonProportional ">.proto</span> files<span id="ITerm64">
                
                
                
              </span>. In doing so, you use the Protocol Buffer message types. Each Protocol Buffer message is a logical grouping of information, containing a series of name-value pairs. Listing <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#PC18">10-13</a></span> is a sample of a <span class="EmphasisFontCategoryNonProportional ">.proto</span> file that defines a message containing information about a <span class="EmphasisFontCategoryNonProportional ">Product</span>, which you used in all of your previous samples.<div class="ProgramCode" id="PC18"><div class="LineGroup"><div class="FixedLine">message Product {</div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;string productId = 1;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;string name = 2;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;string code = 3;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;string title = 4;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;string description = 5;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;string imgUrl = 6;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;double price = 7;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;string productCategoryName = 8;</div><div class="FixedLine">}<span id="ITerm65">
                      
                      
                      
                    </span></div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 10-13</span><p class="SimplePara">Sample .proto <span id="ITerm66">File</span></p></div></div></div></div><div class="Para" id="Par54">Each message (message <span class="EmphasisFontCategoryNonProportional ">Product</span> in your sample) type has one or more uniquely numbered fields, and each field has a name and a value type, where value types can be numbers (integer or floating-point), bools, strings, or raw bytes. Your Protocol Buffer message can also be other protocol buffer message types, as shown in the container message defined in Listing <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#PC19">10-14</a></span> to hold a collection of <span class="EmphasisFontCategoryNonProportional ">Product</span> instances.<div class="ProgramCode" id="PC19"><div class="LineGroup"><div class="FixedLine">message Products {</div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;repeated Product product = 1;</div><div class="FixedLine">}</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 10-14</span><p class="SimplePara">.proto File for a Collection of Other .proto <span id="ITerm67">Types</span></p></div></div></div></div><p class="Para" id="Par55">You can specify fields as optional, required, and/or repeated, as shown in the <span class="EmphasisFontCategoryNonProportional ">Products</span> message.</p><div class="Para" id="Par56">Once you define your messages, you can run the Protocol Buffer compiler for the application’s programming language of your choice on your .<span class="EmphasisFontCategoryNonProportional ">proto</span> file to generate entity classes. These entity classes provide you with simple accessors for each field (like <span class="EmphasisFontCategoryNonProportional ">code()</span> and <span class="EmphasisFontCategoryNonProportional ">set_code()</span>) as well as methods to serialize/parse the whole structure to/from raw bytes. In your scenario, if your chosen language is Java, running the compiler on the above sample will generate a class called <span class="EmphasisFontCategoryNonProportional ">Product</span>. You can use this entity class in your application to marshal and unmarshal <span class="EmphasisFontCategoryNonProportional ">Product</span> protocol buffer messages. Your code will look like that in Listing <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#PC20">10-15</a></span>.<div class="ProgramCode" id="PC20"><div class="LineGroup"><div class="FixedLine">Product product =</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;Product.newBuilder().setProductId(id)</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.setName("Kamsung D3")</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.setCode("KAMSUNG-TRIOS")</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.setTitle("Kamsung Trios 12 inch , black , 12 px ....")</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.setDescription("Kamsung Trios 12 inch with Touch")</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.setImgUrl("kamsung.jpg")</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.setPrice(12000.00)</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.setProductCategoryName("Mobile").build();</div></div><div class="LineGroup"><div class="FixedLine">// write</div><div class="FixedLine">FileOutputStream output = new FileOutputStream("D:/Product.ser");</div><div class="FixedLine">product.writeTo(output);</div><div class="FixedLine">output.close();</div></div><div class="LineGroup"><div class="FixedLine">// read<span id="ITerm68">
                      
                      
                      
                    </span></div><div class="FixedLine">Product productFromFile = Product.parseFrom(new FileInputStream("D:/Product.ser"));</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 10-15</span><p class="SimplePara">Marshalling and Unmarshalling .proto <span id="ITerm69">Types</span></p></div></div></div></div><p class="Para" id="Par57">You can now add new fields to your message formats without breaking <span id="ITerm70">backwards-compatibility</span>; any old program binaries will ignore any new fields when parsing. So by using protocol buffers as the data format, you can extend your message protocol without having to worry about breaking existing code.</p><div class="Para" id="Par58"><span id="ITerm71">Google’s documentation</span> on Protocol Buffer lists the advantages of using Protocol Buffer as follows:<div class="UnorderedList"><ul class="UnorderedListMarkBullet"><li><p class="Para" id="Par59">Simpler</p></li><li><p class="Para" id="Par60">3 to 10 times smaller</p></li><li><p class="Para" id="Par61">20 to 100 times faster</p></li><li><p class="Para" id="Par62">Less ambiguous</p></li><li><p class="Para" id="Par63">Generate data access classes that are easier to use programmatically</p></li></ul></div></div><p class="Para" id="Par64">The second and third bullet points are of great significance especially when you want to design numerous chit-chat kinds of interactions between microservices, which are again too many in number in any serious enterprise-grade application.</p><p class="Para" id="Par65">Let’s now look at a complete example to explain the usage of Protocol Buffer between microservices.</p></section><section class="Section2 RenderAsSection2" id="Sec10"><h3 class="Heading">A Scenario to Demonstrate Protocol Buffer Between Microservices</h3><div class="Para" id="Par66">You will modify the same example you used in your earlier demonstrations to leverage Protocol Buffer. You will use a trimmed down version of the same components used in Chapter <span class="ExternalRef"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_8_Chapter.xhtml" class="totri-footnote"><span class="RefSource">8</span></a></span>. So your example here will consist of three main components: an HTML-based client app and two microservices, as shown in Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#Fig3">10-3</a></span>. Here again I have removed all complexities of <span id="ITerm72">HATEOAS</span> and data repositories so that you can concentrate on the usage of Protocol Buffer alone.<figure class="Figure" id="Fig3"><div class="MediaObject" id="MO3"><img alt="../images/477630_1_En_10_Chapter/477630_1_En_10_Fig3_HTML.jpg" src="./10. Microservice Performance - Practical Microservices Architectural Patterns_ Event-Based Java Microservices with Spring Boot and Spring Cloud_files/477630_1_E(2).jpg" style="height:21.38em" width="1725" height="855" data-mfp-src="/library/view/practical-microservices-architectural/9781484245019/images/477630_1_En_10_Chapter/477630_1_En_10_Fig3_HTML.jpg"></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 10-3</span><p class="SimplePara">Use Protocol Buffer between microservices</p></div></figcaption></figure></div><p class="Para" id="Par67">In your example <span id="ITerm73">design</span>, you use a <span class="EmphasisFontCategoryNonProportional ">.proto</span> file where you spec out the entities you want to use. The next step is to run the Protocol Buffer compiler for the application’s programming language (Java, in your case) on your <span class="EmphasisFontCategoryNonProportional ">.proto</span> file to generate similar classes. Now both the dependent and the independent microservices can be programmed against the generated entity classes, thus making intermicroservices communication using protocol buffer a straightforward step.</p></section><section class="Section2 RenderAsSection2" id="Sec11"><h3 class="Heading">Code to Use Protocol Buffer in Spring Boot</h3><div class="Para" id="Par68">All the code samples for this section are in folder <span class="EmphasisFontCategoryNonProportional ">ch08\ch10-02</span>. You will look at the code for the independent microservice first, the Product Server microservice. Visit <span class="EmphasisFontCategoryNonProportional ">pom.xml</span> to see the explicit mention of the protobuf-java and the <span id="ITerm74">protobuf-java-format dependency</span> for your Product Server microservice. See Listing <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#PC21">10-16</a></span>.<div class="ProgramCode" id="PC21"><div class="LineGroup"><div class="FixedLine">&lt;project&gt;</div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&lt;properties&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;protobuf-java.version&gt;3.1.0&lt;/protobuf-java.version&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;protobuf-java-format.version&gt;1.4&lt;/protobuf-java-format.version&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&lt;/properties&gt;</div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&lt;dependencies&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;dependency&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;groupId&gt;com.google.protobuf&lt;/groupId&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;artifactId&gt;protobuf-java&lt;/artifactId&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;version&gt;${protobuf-java.version}&lt;/version&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/dependency&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;dependency&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;groupId&gt;com.googlecode.protobuf-java-format&lt;/groupId&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;artifactId&gt;protobuf-java-format&lt;/artifactId&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;version&gt;${protobuf-java-format.version}&lt;/version&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/dependency&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;dependency&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/dependency&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&lt;/dependencies&gt;</div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&lt;build&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;plugins&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;plugin&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/plugin&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;plugin&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;groupId&gt;com.github.os72&lt;/groupId&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;artifactId&gt;protoc-jar-maven-plugin&lt;/artifactId&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;version&gt;3.1.0&lt;/version&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;executions&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;execution&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;phase&gt;generate-sources&lt;/phase&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;goals&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;goal&gt;run&lt;/goal&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/goals&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;configuration&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;protocVersion&gt;3.1.0&lt;/protocVersion&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;includeStdTypes&gt;true&lt;/includeStdTypes&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;includeDirectories&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;include&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;src/main/resources</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/include&gt;<span id="ITerm75">
                      
                      
                      
                    </span></div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/includeDirectories&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;inputDirectories&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;include&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;src/main/protobuf</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/include&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/inputDirectories&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/configuration&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/execution&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/executions&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/plugin&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/plugins&gt;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&lt;/build&gt;</div></div><div class="LineGroup"><div class="FixedLine">&lt;/project&gt;</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 10-16</span><p class="SimplePara">Adding a Protocol Buffer Compiler and Runtime to the Maven Build (ch10\ch10-02\ProductServer\pom.xml)</p></div></div></div></div><p class="Para" id="Par69"><span id="ITerm76">protoc-jar-maven-plugin</span> performs protobuf code generation using the multi-platform executable protoc-jar. At build time, this Maven plugin detects the platform and executes the corresponding protoc binary so that it can compile <span class="EmphasisFontCategoryNonProportional ">.proto</span> files using protoc-jar embedded protoc compiler, providing some portability across the major platforms (Linux, Mac/OSX, and Windows). In the <span class="EmphasisFontCategoryNonProportional ">pom.xml</span> above, the compiler compiles <span class="EmphasisFontCategoryNonProportional ">.proto</span> files in the main cycle and places the generated files into target/generated-sources, including google.protobuf standard types, and includes any additional imports required.</p><p class="Para" id="Par70">The protobuf-java Maven artifact provides the Java APIs required to serialize the generated message objects in Java. So it acts as the runtime for Protocol Buffer.</p><p class="Para" id="Par71">Note that the compiler version should be same as the Java API version. In your sample, you use the 3.1.0 version.</p><p class="Para" id="Par72">The <span id="ITerm77">protobuf-java-format</span> Maven artifact provides serialization and deserialization of different formats based on Google’s protobuf Message. It enables overriding the default (byte array) output to text based formats such as XML, JSON, and HTML.</p><div class="Para" id="Par73">Now, look at the Protocol Buffer type declaration shown in Listing <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#PC22">10-17</a></span>.<div class="ProgramCode" id="PC22"><div class="LineGroup"><div class="FixedLine">syntax = "proto3";</div></div><div class="LineGroup"><div class="FixedLine">package binildas;</div></div><div class="LineGroup"><div class="FixedLine">option java_package = "com.acme.ecom.product.model";</div><div class="FixedLine">option java_outer_classname = "ECom";</div></div><div class="LineGroup"><div class="FixedLine">message Products {</div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;repeated Product product = 1;</div><div class="FixedLine">}<span id="ITerm78">
                      
                      
                      
                    </span></div><div class="FixedLine">message Product {</div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;string productId = 1;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;string name = 2;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;string code = 3;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;string title = 4;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;string description = 5;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;string imgUrl = 6;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;double price = 7;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;string productCategoryName = 8;</div><div class="FixedLine">}</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 10-17</span><p class="SimplePara">Type Declaration in product.proto (ch10\ch10-02\ProductServer\src\main\resources\product.proto)</p></div></div></div></div><p class="Para" id="Par74">Since you use version 3 of both the protocol buffer compiler and the protocol buffer language runtime, the <span class="EmphasisFontCategoryNonProportional ">.proto</span> file must start with the <span class="EmphasisFontCategoryNonProportional ">syntax = “proto3”</span> declaration. If a compiler version 2 is used instead, this declaration would be omitted.</p><p class="Para" id="Par75">The <span class="EmphasisFontCategoryNonProportional ">.proto</span> file should next have a package declaration, which helps prevent naming conflicts between different type declarations across different projects. In Java, this package name is also used as the Java package unless you have explicitly specified a <span class="EmphasisFontCategoryNonProportional ">java_package</span>, as you have here.</p><p class="Para" id="Par76">Next are two Java-specific options: the <span class="EmphasisFontCategoryNonProportional ">java_package</span> and <span class="EmphasisFontCategoryNonProportional ">java_outer_classname</span>. The <span class="EmphasisFontCategoryNonProportional ">java_package</span> option specifies in what Java package your generated classes should live. If you don’t specify this explicitly, it matches the package name given by the package declaration. The <span class="EmphasisFontCategoryNonProportional ">java_outer_classname</span><span id="ITerm79">
                
                
                
              </span> option defines the container class name, which should contain all of the classes generated in the type definition file.</p><p class="Para" id="Par77">Next, you add a message for each data structure you want to serialize and then specify a name and a type for each field in the message. A message is an aggregate containing a set of typed fields. Many standard simple data types are available as field types, including bool, int32, float, double, and string. You can also add other message types as field types; in your example, the <span class="EmphasisFontCategoryNonProportional ">Products</span> message contains Product messages. The <span class="EmphasisFontCategoryNonProportional ">= 1</span>, <span class="EmphasisFontCategoryNonProportional ">= 2</span>, <span class="EmphasisFontCategoryNonProportional ">= 3</span>, etc. are markers on each element to identify the unique “tag” that the field uses in the binary encoding.</p><div class="Para" id="Par78">Fields can be annotated with one of the following modifiers:<div class="UnorderedList"><ul class="UnorderedListMarkBullet"><li><p class="Para" id="Par79"><strong class="EmphasisTypeBold ">required</strong>: Indicates that a value for the field must be provided; otherwise the message will be considered “uninitialized.”</p></li><li><p class="Para" id="Par80"><strong class="EmphasisTypeBold ">optional</strong>: Indicates that the field may or may not be set. If an optional field value isn’t set, a default value is used, like zero for numeric types, the empty string for strings, false for Booleans, etc.</p></li><li><p class="Para" id="Par81"><strong class="EmphasisTypeBold ">repeated</strong>: Indicates that the field may be repeated any number of times (including zero). The order of the repeated values will be preserved in the protocol buffer.</p></li></ul></div></div><div class="Para" id="Par82">Next, look at the <span id="ITerm80">Product Server Controller</span> in Listing <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#PC23">10-18</a></span>.<div class="ProgramCode" id="PC23"><div class="LineGroup"><div class="FixedLine">package com.acme.ecom.product.controller;</div></div><div class="LineGroup"><div class="FixedLine">import com.acme.ecom.product.model.ECom.Product;</div><div class="FixedLine">import com.acme.ecom.product.model.ECom.Products;</div></div><div class="LineGroup"><div class="FixedLine">@RestController</div><div class="FixedLine">public class ProductRestController {</div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;@RequestMapping(value = "/products", method = RequestMethod.GET)</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;&nbsp;Products getAllProducts() {</div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List&lt;Product&gt; products = getAllTheProducts();</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(products.isEmpty()){</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOGGER.debug("No products retreived from repository");</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;products.forEach(item-&gt;LOGGER.debug(item.toString()));</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Products productsParent =</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Products.newBuilder().addAllProduct(products).build();</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return productsParent;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;}<span id="ITerm81">
                      
                      
                      
                    </span></div><div class="FixedLine">}</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 10-18</span><p class="SimplePara">Product Rest Controller to Emit Protocol Buffer (ch10\ch10-02\ProductServer\src\main\java\com\acme\ecom\product\controller\ProductRestController.java)</p></div></div></div></div><p class="Para" id="Par83">There is no major noticeable difference in the Rest Controller except the fact that you need to import Products and Product Java types defined within the outer container class, <span class="EmphasisFontCategoryNonProportional ">ECom</span>.</p><div class="Para" id="Par84">You now need to instrument the microservice runtime with the required libraries to serialize and deserialize to the Protocol Buffer format. Spring’s <span class="EmphasisFontCategoryNonProportional ">ProtobufHttpMessageConverter</span> comes handy to internally leverage Google’s libraries. This converter supports by default <span class="EmphasisFontCategoryNonProportional ">application/x-protobuf</span> and <span class="EmphasisFontCategoryNonProportional ">text/plain</span> with the official com.google.protobuf:protobuf-java library. It is to be noted that other formats can also be supported with the correct additional libraries on the classpath. You will instantiate this bean in a configuration class; see Listing <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#PC24">10-19</a></span>.<div class="ProgramCode" id="PC24"><div class="LineGroup"><div class="FixedLine">import org.springframework.http.converter.protobuf.ProtobufHttpMessageConverter;</div></div><div class="LineGroup"><div class="FixedLine">@Configuration</div><div class="FixedLine">public class ProductRestControllerConfiguration{</div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;@Bean</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;ProtobufHttpMessageConverter protobufHttpMessageConverter() {</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return new ProtobufHttpMessageConverter();</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;}</div><div class="FixedLine">}</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 10-19</span><p class="SimplePara">Configuring Protocol Buffer <span id="ITerm82">Message Converter</span> (ch10\ch10-02\ProductServer\src\main\java\com\acme\ecom\product\controller\ProductRestControllerConfiguration.java)</p></div></div></div></div><p class="Para" id="Par85">That’s all for the Product Server microservice. Now you will look at the code for the Product Web <span id="ITerm83">microservices</span>. All of the code snippets you have seen and the explanations I have made for the Product Server microservice are still valid, so I will not repeat them here for brevity; instead, I will explain any additional requirements.</p><div class="Para" id="Par86">The Product Web microservice must delegate requests to the Product Server microservice. To make this delegation work, you need a bean of the RestTemplate type to be registered in a configuration class. This <span id="ITerm84">RestTemplate</span> is injected with another bean of the ProtobufHttpMessageConverter type, which will help to automatically transform the received protocol buffer messages. This is shown in Listing <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#PC25">10-20</a></span>.<div class="ProgramCode" id="PC25"><div class="LineGroup"><div class="FixedLine">@Configuration</div><div class="FixedLine">public class ProductRestControllerConfiguration{</div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;@Bean</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;RestTemplate restTemplate(ProtobufHttpMessageConverter hmc) {</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return new RestTemplate(Arrays.asList(hmc));</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;}</div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;@Bean</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;ProtobufHttpMessageConverter protobufHttpMessageConverter() {</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return new ProtobufHttpMessageConverter();</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;}</div><div class="FixedLine">}</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 10-20</span><p class="SimplePara">Rest Template to Invoke Protocol Buffer (ch10\ch10-02\ProductWeb\src\main\java\com\acme\ecom\product\controller\ProductRestControllerConfiguration.java)</p></div></div></div></div><div class="Para" id="Par87">Next, the Rest Controller for the Product Web microservice will leverage the above <span id="ITerm85">RestTemplate</span> to delegate calls to the Product Server microservice, as shown in Listing <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#PC26">10-21</a></span>.<div class="ProgramCode" id="PC26"><div class="LineGroup"><div class="FixedLine">@RestController</div><div class="FixedLine">public class ProductRestController{</div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;@Autowired</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;RestTemplate restTemplate;</div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;private static String PRODUCT_SERVICE_URL =</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"http://localhost:8081/products/";</div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;@Autowired</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;public ProductRestController(RestTemplate restTemplate){</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.restTemplate = restTemplate;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;}<span id="ITerm86">
                      
                      
                      
                    </span></div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;@RequestMapping(value = "/productsweb", method = RequestMethod.GET,</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;produces = {MediaType.APPLICATION_JSON_VALUE})</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;&nbsp;Products getAllProducts() {</div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Products products = restTemplate.getForObject(PRODUCT_SERVICE_URL,</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Products.class);</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List&lt;Product&gt; productsList = products.getProductList();</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Products productsParent =</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Products.newBuilder().addAllProduct(productsList).build();</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return productsParent;</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;}</div><div class="FixedLine">}</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 10-21</span><p class="SimplePara">Rest Controller Delegating Calls to Microservice Spitting Protocol Buffer (ch10\ch10-02\ProductWeb\src\main\java\com\acme\ecom\product\controller\ProductRestController.java)</p></div></div></div></div></section><section class="Section2 RenderAsSection2" id="Sec12"><h3 class="Heading">Build and Test the Protocol Buffer Between Microservices</h3><p class="Para" id="Par88">Once your message structure is defined in a <span class="EmphasisFontCategoryNonProportional ">.proto</span> file<span id="ITerm87">
                
                
                
              </span>, you need a protoc compiler to convert this language-neutral content to Java code. Follow the instructions in the Protocol Buffer’s repository (<span class="ExternalRef"><a href="https://github.com/google/protobuf"><span class="RefSource">
                  <span class="EmphasisFontCategoryNonProportional ">https://github.com/google/protobuf</span>
                </span></a></span>) in order to get an appropriate compiler version. Alternatively, you can download a prebuilt binary compiler from the Maven central repository by searching for the com.google.protobuf:protoc artifact and then picking an appropriate version for your platform.</p><div class="Para" id="Par89">Next, you need to run the compiler, specifying the path to search for the <span class="EmphasisFontCategoryNonProportional ">.proto</span> files<span id="ITerm88">
                
                
                
              </span>, the destination directory where you want the generated code to go, and the absolute path to your .proto. In your case, it will look like:<div class="ProgramCode" id="PC27"><div class="LineGroup"><div class="FixedLine">D:\Applns\Google\ProtocolBuffer\protoc-3.4.0-win32\bin\protoc --proto_path .\src\main\resources --java_out .\src\main\java .\src\main\resources\product.proto</div></div></div></div><p class="Para" id="Par90">Because you want Java classes, you use the <span class="EmphasisFontCategoryNonProportional ">--java_out</span> option; however, similar options are provided for other supported languages.</p><p class="Para" id="Par91">The above steps are handy, but they are not straightforward to weave into the Maven build. That’s why you used the <span id="ITerm89">protoc-jar-maven-plugin</span> in the <span class="EmphasisFontCategoryNonProportional ">pom.xml</span> in Listing <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#PC21">10-16</a></span>; it performs protobuf code generation using the multiplatform executable protoc-jar. Hence no manual steps are needed to build and run the samples. Let’s get started.</p><p class="Para" id="Par92">The complete code required to demonstrate intermicroservices communication using Protocol Buffer is kept inside folder <span class="EmphasisFontCategoryNonProportional ">ch10\ch10-02</span>. You don’t need MongoDB for this sample. You can build, pack, and run the different microservices in the following order.</p><div class="Para" id="Par93">Bring up the Product Server microservice first:<div class="ProgramCode" id="PC28"><div class="LineGroup"><div class="FixedLine">cd ch10\ch10-02\ProductServer</div><div class="FixedLine">D:\binil\gold\pack03\ch10\ch10-02\ProductServer&gt;make</div><div class="FixedLine">D:\binil\gold\pack03\ch10\ch10-02\ProductServer&gt;rem D:\Applns\Google\ProtocolBuffer\protoc-3.4.0-win32\bin\protoc --proto_path .\src\main\resources --java_out .\src\main\java .\src\main\resources\product.proto</div><div class="FixedLine">D:\binil\gold\pack03\ch10\ch10-02\ProductServer&gt;mvn -Dmaven.test.skip=true clean package</div><div class="FixedLine">D:\binil\gold\pack03\ch10\ch10-02\ProductServer&gt;run</div><div class="FixedLine">D:\binil\gold\pack03\ch10\ch10-02\ProductServer&gt;java -jar -Dserver.port=8080 .\target\Ecom-Product-Microservice-0.0.1-SNAPSHOT.jar</div></div></div></div><div class="Para" id="Par94">The above command will bring up the Product Server microservice in port 8080. You also want to inspect the format of the messages flowing through the wire, so you use Apache <span id="ITerm90">TCPMon</span> as a proxy. See Appendix E to start TCPMon as a proxy.<div class="ProgramCode" id="PC29"><div class="LineGroup"><div class="FixedLine">cd D:\Applns\apache\TCPMon\tcpmon-1.0-bin\build</div><div class="FixedLine">D:\Applns\apache\TCPMon\tcpmon-1.0-bin\build&gt;tcpmon 8081 127.0.0.1 8080</div></div></div></div><div class="Para" id="Par95">This will bring up <span id="ITerm91">TCPMon</span> so that all requests hitting port 8081 in the host where the TCPMon is running (localhost, in your case) will be proxied to port 8080 in host 127.0.0.1 in the above case. See Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#Fig4">10-4</a></span>.<figure class="Figure" id="Fig4"><div class="MediaObject" id="MO4"><img alt="../images/477630_1_En_10_Chapter/477630_1_En_10_Fig4_HTML.jpg" src="./10. Microservice Performance - Practical Microservices Architectural Patterns_ Event-Based Java Microservices with Spring Boot and Spring Cloud_files/477630_1_E(3).jpg" style="height:17.92em" width="1725" height="717" data-mfp-src="/library/view/practical-microservices-architectural/9781484245019/images/477630_1_En_10_Chapter/477630_1_En_10_Fig4_HTML.jpg"></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 10-4</span><p class="SimplePara">TCPMon<span id="ITerm92">
                        
                        
                        
                      </span> Proxy set to monitor requests and responses</p></div></figcaption></figure></div><div class="Para" id="Par96">Next, bring up the Product Web microservice:<div class="ProgramCode" id="PC30"><div class="LineGroup"><div class="FixedLine">cd ch10\ch10-02\ProductWeb</div><div class="FixedLine">D:\binil\gold\pack03\ch10\ch10-02\ProductWeb&gt;make</div></div><div class="LineGroup"><div class="FixedLine">D:\binil\gold\pack03\ch10\ch10-02\ProductWeb&gt;mvn -Dmaven.test.skip=true clean package</div><div class="FixedLine">D:\binil\gold\pack03\ch10\ch10-02\ProductWeb&gt;run</div><div class="FixedLine">D:\binil\gold\pack03\ch10\ch10-02\ProductWeb&gt;java -Dserver.port=8082 -jar .\target\Ecom-Product-Microservice-0.0.1-SNAPSHOT.jar</div></div></div></div><div class="Para" id="Par97">You can now test the application by pointing to the URL to retrieve the HTML-based client app, preferably using the Chrome browser:<div class="ProgramCode" id="PC31"><div class="LineGroup"><div class="FixedLine">http://localhost:8082/</div></div></div></div><p class="Para" id="Par98">Upon loading itself, the browser client will fire a request to Product Web, listening on port 8082, which will delegate the request to the <span id="ITerm93">Apache TCPMon Proxy</span> listening on port 8081. This request hitting port 8081 in the host where the TCPMon is running (localhost, in your case) will be proxied to port 8080 in localhost, again where the Product Server microservice is listening. If everything goes as planned, you should be able to see the products listed on the web page. If you inspect the TCPMon <span id="ITerm94">Proxy</span> console, you should be able to validate that the communication between the two microservices uses Protocol Buffer as the wire-level protocol in handshaking the HTTP-based REST invocation.</p></section><section class="Section2 RenderAsSection2" id="Sec13"><h3 class="Heading">The Impact of Using Protocol Buffer</h3><p class="Para" id="Par99">Let’s inspect the response content length while using Protocol Buffer for intermicroservices communications. For this comparison, you will look at three scenarios.</p><section class="Section3 RenderAsSection3" id="Sec14"><h4 class="Heading">Protocol Buffer Encoding</h4><div class="Para" id="Par100">The sample demonstration in the previous section explained how to use Protocol Buffer for intermicroservices communications. You can observe the <span id="ITerm95">TCPMon</span> Proxy console where you should be able to validate that the communication between the two microservices uses Protocol Buffer. It will also say that the response content length is 265 (which is representative). See Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#Fig5">10-5</a></span>.<figure class="Figure" id="Fig5"><div class="MediaObject" id="MO5"><img alt="../images/477630_1_En_10_Chapter/477630_1_En_10_Fig5_HTML.jpg" src="./10. Microservice Performance - Practical Microservices Architectural Patterns_ Event-Based Java Microservices with Spring Boot and Spring Cloud_files/477630_1_E(4).jpg" style="height:40.12em" width="1725" height="1605" data-mfp-src="/library/view/practical-microservices-architectural/9781484245019/images/477630_1_En_10_Chapter/477630_1_En_10_Fig5_HTML.jpg"></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 10-5</span><p class="SimplePara">Inspect the Protocol Buffer encoding using <span id="ITerm96">TCPMon</span></p></div></figcaption></figure></div></section><section class="Section3 RenderAsSection3" id="Sec15"><h4 class="Heading">XML Encoding</h4><div class="Para" id="Par101">You can use <span id="ITerm97">Chrome</span> and hit the TCPMon Proxy directly so that the client doesn’t explicitly ask for Protocol Buffer during content negotiation using the URL <span class="EmphasisFontCategoryNonProportional ">http://localhost:8081/products/</span>. This will show the response in XML format; see Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#Fig6">10-6</a></span>.<figure class="Figure" id="Fig6"><div class="MediaObject" id="MO6"><img alt="../images/477630_1_En_10_Chapter/477630_1_En_10_Fig6_HTML.jpg" src="./10. Microservice Performance - Practical Microservices Architectural Patterns_ Event-Based Java Microservices with Spring Boot and Spring Cloud_files/477630_1_E(5).jpg" style="height:33.78em" width="1725" height="1351" data-mfp-src="/library/view/practical-microservices-architectural/9781484245019/images/477630_1_En_10_Chapter/477630_1_En_10_Fig6_HTML.jpg"></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 10-6</span><p class="SimplePara">Inspect the XML encoding using <span id="ITerm98">TCPMon</span></p></div></figcaption></figure></div><div class="Para" id="Par102">You can examine the content size using any tool (I use Microsoft Word in Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#Fig7">10-7</a></span>).<figure class="Figure" id="Fig7"><div class="MediaObject" id="MO7"><img alt="../images/477630_1_En_10_Chapter/477630_1_En_10_Fig7_HTML.jpg" src="./10. Microservice Performance - Practical Microservices Architectural Patterns_ Event-Based Java Microservices with Spring Boot and Spring Cloud_files/477630_1_E(6).jpg" style="height:28.03em" width="1725" height="1121" data-mfp-src="/library/view/practical-microservices-architectural/9781484245019/images/477630_1_En_10_Chapter/477630_1_En_10_Fig7_HTML.jpg"></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 10-7</span><p class="SimplePara">Content length while encoding using <span id="ITerm99">XML</span></p></div></figcaption></figure></div></section><section class="Section3 RenderAsSection3" id="Sec16"><h4 class="Heading">JSON Encoding</h4><div class="Para" id="Par103">One easy method to force <span id="ITerm100">JSON encoding</span> between the microservices call is to slightly change the application code in the Product Server microservice. See Listing <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#PC32">10-22</a></span>.<div class="ProgramCode" id="PC32"><div class="LineGroup"><div class="FixedLine">@RequestMapping(value = "/products", method = RequestMethod.GET,</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;produces = {MediaType.APPLICATION_JSON_VALUE})</div><div class="FixedLine">//@RequestMapping(value = "/products", method = RequestMethod.GET)</div><div class="FixedLine">public&nbsp;&nbsp;Products getAllProducts() {</div></div><div class="LineGroup"><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;List&lt;Product&gt; products = getAllTheProducts();</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;Products productsParent =&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Products.newBuilder().addAllProduct(products).build();</div><div class="FixedLine">&nbsp;&nbsp;&nbsp;&nbsp;return productsParent;</div><div class="FixedLine">}</div></div><div class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Listing 10-22</span><p class="SimplePara">Enforce JSON Encoding (ch10\ch10-02\ProductServer\src\main\java\com\acme\ecom\product\controller\ProductRestController.java)</p></div></div></div></div><p class="Para" id="Par104">You can now rebuild and restart the Product Server microservice and rerun the client application by going to <span class="EmphasisFontCategoryNonProportional ">http://localhost:8082/</span>.</p><div class="Para" id="Par105">If you inspect the TCPMon Proxy console, you should be able to see that <span id="ITerm101">JSON encoding</span> is opted in this case, as shown in Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#Fig8">10-8</a></span>.<figure class="Figure" id="Fig8"><div class="MediaObject" id="MO8"><img alt="../images/477630_1_En_10_Chapter/477630_1_En_10_Fig8_HTML.jpg" src="./10. Microservice Performance - Practical Microservices Architectural Patterns_ Event-Based Java Microservices with Spring Boot and Spring Cloud_files/477630_1_E(7).jpg" style="height:31.78em" width="1725" height="1271" data-mfp-src="/library/view/practical-microservices-architectural/9781484245019/images/477630_1_En_10_Chapter/477630_1_En_10_Fig8_HTML.jpg"></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 10-8</span><p class="SimplePara">Inspect JSON encoding using <span id="ITerm102">TCPMon</span></p></div></figcaption></figure></div><div class="Para" id="Par106">You can again examine the content size using any tool (see Figure <span class="InternalRef"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#Fig9">10-9</a></span>).<figure class="Figure" id="Fig9"><div class="MediaObject" id="MO9"><img alt="../images/477630_1_En_10_Chapter/477630_1_En_10_Fig9_HTML.jpg" src="./10. Microservice Performance - Practical Microservices Architectural Patterns_ Event-Based Java Microservices with Spring Boot and Spring Cloud_files/477630_1_E(8).jpg" style="height:24.12em" width="1499" height="965" data-mfp-src="/library/view/practical-microservices-architectural/9781484245019/images/477630_1_En_10_Chapter/477630_1_En_10_Fig9_HTML.jpg"></div><figcaption class="Caption" lang="en"><div class="CaptionContent"><span class="CaptionNumber">Figure 10-9</span><p class="SimplePara">Content length while encoding using <span id="ITerm103">JSON</span></p></div></figcaption></figure></div><p class="Para" id="Par107">You can now compare these three scenarios and get an idea of the variation in the size of the response while using Protocol Buffer for communication between microservices.</p></section></section></section><section class="Section1 RenderAsSection1" id="Sec17"><h2 class="Heading">Summary</h2><p class="Para" id="Par108">Microservices are like double-edged swords: they provide extra leverage but should be used with care. This is mainly due to the Inversion of Architecture discussed in Chapter <span class="ExternalRef"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_4_Chapter.xhtml" class="totri-footnote"><span class="RefSource">4</span></a></span>. You learned two refactoring processes you can bring to your microservices architecture to influence the performance to a greater extent. There are more optimizations; however, I will limit them to the two discussed in this chapter. A major chunk of the rest of the book will talk about event-based microservices where the asynchronous nature of intermicroservices communications is leveraged by default using messaging instead of HTTP. You’ll start getting into those aspects in the next chapter.</p></section></div><div class="annotator-outer annotator-viewer viewer annotator-hide">
  <ul class="annotator-widget annotator-listing"></ul>
</div><div class="annotator-modal-wrapper annotator-editor-modal annotator-editor annotator-hide">
	<div class="annotator-outer editor">
		<h2 class="title">Highlight</h2>
		<form class="annotator-widget">
			<ul class="annotator-listing">
			<li class="annotator-item"><textarea id="annotator-field-1" placeholder="Add a note using markdown (optional)" class="js-editor" maxlength="750"></textarea></li></ul>
			<div class="annotator-controls">
				<a class="link-to-markdown" href="https://daringfireball.net/projects/markdown/basics" target="_blank">?</a>
				<ul>
					<li class="delete annotator-hide"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#delete" class="annotator-delete-note button positive">Delete Note</a></li>
					<li class="save"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#save" class="annotator-save annotator-focus button positive">Save Note</a></li>
					<li class="cancel"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#cancel" class="annotator-cancel button">Cancel</a></li>
				</ul>
			</div>
		</form>
	</div>
</div><div class="annotator-modal-wrapper annotator-delete-confirm-modal" style="display: none;">
  <div class="annotator-outer">
    <h2 class="title">Highlight</h2>
      <a class="js-close-delete-confirm annotator-cancel close" href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#close">Close</a>
      <div class="annotator-widget">
         <div class="delete-confirm">
            Are you sure you want to permanently delete this note?
         </div>
         <div class="annotator-controls">
            <a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#cancel" class="annotator-cancel button js-cancel-delete-confirm">No, I changed my mind</a>
            <a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#delete" class="annotator-delete button positive js-delete-confirm">Yes, delete it</a>
         </div>
       </div>
   </div>
</div><div class="annotator-adder" style="display: none;">
	<ul class="adders">
		
		<li class="copy"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#">Copy</a></li>
		
		<li class="add-highlight"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#">Add Highlight</a></li>
		<li class="add-note"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#">
			Add Note
		</a></li>
		
	</ul>
</div></div></div>



  <div class="t-sbo-prev sbo-prev sbo-nav-bottom">
  
    
      
        <a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_9_Chapter.xhtml" class="prev nav-link">
      
          <span aria-hidden="true" class="pagination-label t-prev-label">Prev</span>
          <span class="visuallyhidden">Previous Chapter</span>
          <div class="pagination-title t-prev-title">9.&nbsp;High Availability and Microservices</div>
        </a>
    
  
  </div>

  <div class="t-sbo-next sbo-next sbo-nav-bottom">
  
    
      
        <a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_11_Chapter.xhtml" class="next nav-link">
      
          <span aria-hidden="true" class="pagination-label t-next-label">Next</span>
          <span class="visuallyhidden">Next Chapter</span>
          <div class="pagination-title t-next-title">11.&nbsp;Events, Eventuality, and Consistency</div>
        </a>
    
  
  </div>

</section>
  </div>
<section class="sbo-saved-archives"></section>



          
          
  




    
    



        
      </div><div style="width:0px; height:0px; display:none; visibility:hidden;" id="batBeacon0.2942088947974124"><img style="width:0px; height:0px; display:none; visibility:hidden;" id="batBeacon0.8351993044108099" width="0" height="0" alt="" src="./10. Microservice Performance - Practical Microservices Architectural Patterns_ Event-Based Java Microservices with Spring Boot and Spring Cloud_files/0"></div>
      
        

<footer class="pagefoot t-pagefoot">
  <a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#" class="icon-up" onclick="window.Appcues.track(&#39;JumpTop_HeronBook&#39;)" style="display: block;"><div class="visuallyhidden">Back to top</div></a>
  <ul class="js-footer-nav">
  
    
    <li><a href="https://learning.oreilly.com/u/preferences/">Settings</a></li>
    
    <li><a href="https://learning.oreilly.com/public/support/">Support</a></li>
    
    <li><a href="https://learning.oreilly.com/accounts/logout/">Sign Out</a></li>
    
  
  
  </ul>
  <span class="copyright">© 2020 <a href="https://learning.oreilly.com/" target="_blank">O'Reilly Media, Inc</a>.</span>
  
    
    <a href="https://www.oreilly.com/terms/">Terms of Service</a> 
     / 
    
    <a href="https://learning.oreilly.com/privacy">Privacy Policy</a> 
    
    
  
</footer>

      
    
    <script src="./10. Microservice Performance - Practical Microservices Architectural Patterns_ Event-Based Java Microservices with Spring Boot and Spring Cloud_files/saved_resource" charset="utf-8"></script>
    <script src="./10. Microservice Performance - Practical Microservices Architectural Patterns_ Event-Based Java Microservices with Spring Boot and Spring Cloud_files/saved_resource(1)" charset="utf-8"></script>
  

<div></div><div></div><iframe src="./10. Microservice Performance - Practical Microservices Architectural Patterns_ Event-Based Java Microservices with Spring Boot and Spring Cloud_files/frame.html" id="just-me" name="just-me" seamless="true" tabindex="-1" allowtransparency="true" style="display: none;" width="100%" height="100%"></iframe><div class="annotator-notice"></div><div class="font-flyout" style="top: 200.969px; left: 1280px;"><div class="font-controls-panel">
	<div class="nightmodes">
		<ul>
			<li class="day"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#" id="day-mode" title="Day Mode">
				<i class="fa fa-sun-o"></i>
				<span>Day Mode</span></a></li>
			<li class="cloudy"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#" id="cloudy-mode" title="Cloudy Mode">
				<i class="fa fa-cloud"></i>
				<span>Cloud Mode</span>
			</a></li>
			<li class="night"><a href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#" id="night-mode" title="Night Mode">
				<i class="fa fa-moon-o"></i>
				<span>Night Mode</span>
			</a></li>
		</ul>
	</div>

	<div class="font-resizer resizer">
		<div class="draggable-containment-wrapper">
			<i class="fa fa-font left"></i>
			<span class="filler" style="width: 50%;"></span>
			<div id="js-font-size-draggable" class="draggable ui-widget-content ui-draggable ui-draggable-handle" style="position: relative; left: 80px;"></div>
			<i class="fa fa-font right"></i>
		</div>
	</div>

	<div class="column-resizer resizer">
		<div class="draggable-containment-wrapper">
			<i class="fa fa-compress left"></i>
			<span class="filler" style="width: 50%;"></span>
			<div id="js-column-size-draggable" class="draggable ui-widget-content ui-draggable ui-draggable-handle" style="position: relative; left: 80px;"></div>
			<i class="fa fa-expand right"></i>
		</div>
	</div>

	<a id="reset" class="button" href="https://learning.oreilly.com/library/view/practical-microservices-architectural/9781484245019/html/477630_1_En_10_Chapter.xhtml#">Reset</a>
</div>
</div><script type="text/javascript" async="" src="./10. Microservice Performance - Practical Microservices Architectural Patterns_ Event-Based Java Microservices with Spring Boot and Spring Cloud_files/generic1595942691.下载" charset="UTF-8"></script><span></span><div style="display: none; visibility: hidden;"><script>(function(){if(null!==document.querySelector('iframe[title\x3d"fb:share_button Facebook Social Plugin"]')&&void 0!==document.querySelector('iframe[title\x3d"fb:share_button Facebook Social Plugin"]')){var a=!1;window.addEventListener("blur",function(){a&&dataLayer.push({event:"eventTracker",eventCat:"social",eventAct:"share",eventLbl:"facebook",eventVal:0,nonInteraction:0})});document.querySelector('iframe[title\x3d"fb:share_button Facebook Social Plugin"]').addEventListener("mouseover",function(){window.focus();
a=!0});document.querySelector('iframe[title\x3d"fb:share_button Facebook Social Plugin"]').addEventListener("mouseout",function(){a=!1})}if(null!==document.querySelector("iframe.twitter-share-button")&&void 0!==document.querySelector("iframe.twitter-share-button")){var b=!1;window.addEventListener("blur",function(){b&&dataLayer.push({event:"eventTracker",eventCat:"social",eventAct:"share",eventLbl:"twitter",eventVal:0,nonInteraction:0})});document.querySelector("iframe.twitter-share-button").addEventListener("mouseover",
function(){window.focus();b=!0});document.querySelector("iframe.twitter-share-button").addEventListener("mouseout",function(){b=!1})}try{window.twttr=function(a,b,d){var c,e=a.getElementsByTagName(b)[0];if(!a.getElementById(d))return a=a.createElement(b),a.id=d,a.src="//platform.twitter.com/widgets.js",e.parentNode.insertBefore(a,e),window.twttr||(c={_e:[],ready:function(a){c._e.push(a)}})}(document,"script","twitter-wjs"),twttr.ready(function(a){a.events.bind("tweet",trackTwitter)})}catch(c){}})();
null!==document.querySelector(".IN-widget")&&void 0!==document.querySelector(".IN-widget")&&document.querySelector(".IN-widget").addEventListener("click",function(){dataLayer.push({event:"eventTracker",eventCat:"social",eventAct:"share",eventLbl:"linkedin",eventVal:0,nonInteraction:0})});
function trackTwitter(a){a&&(a.target&&"IFRAME"==a.target.nodeName&&(opt_target=extractParamFromUri(a.target.src,"url")),dataLayer.push({event:"eventTracker",eventCat:"social",eventAct:"share",eventLbl:"twitter",eventVal:0,nonInteraction:0}))}function extractParamFromUri(a,b){if(a&&(b=new RegExp("[\\?\x26#]"+b+"\x3d([^\x26#]*)"),a=b.exec(a),null!=a))return unescape(a[1])};</script></div><script type="text/javascript" id="">function forceInputUppercase(a){var b=a.target.selectionStart,c=a.target.selectionEnd;a.target.value=a.target.value.toUpperCase();a.target.setSelectionRange(b,c)}void 0!=document.getElementById("id_promotion")&&null!=document.getElementById("id_promotion")&&document.getElementById("id_promotion").addEventListener("keyup",forceInputUppercase,!1);
void 0!=document.getElementsByName("promotionCode")[0]&&null!=document.getElementsByName("promotionCode")[0]&&document.getElementsByName("promotionCode")[0].addEventListener("keyup",forceInputUppercase,!1);</script><script type="text/javascript" id="">var nonwExpandable=document.querySelectorAll(".orm-ff-NavigationSubnav-headerListItem a, .orm-ff-NavigationView-headerListItem a");nonwExpandable.forEach(function(a,b){b+1!=nonwExpandable.length?a.addEventListener("click",function(){dataLayer.push({event:"eventTracker",eventCat:"global nav",eventAct:"navigation",eventLbl:a.childNodes[1].textContent})}):b+1==nonwExpandable.length&&a.addEventListener("click",function(){dataLayer.push({event:"eventTracker",eventCat:"user login",eventAct:"logout",eventLbl:"global nav | unified"})})});
var nonwExpandableFo=document.querySelectorAll(".drop-content li:not(.flyout-parent) a");
nonwExpandableFo.forEach(function(a,b){"drop-content"==a.parentNode.parentNode.parentNode.className&&b+1!=nonwExpandableFo.length?a.addEventListener("click",function(){dataLayer.push({event:"eventTracker",eventCat:"global nav",eventAct:"navigation",eventLbl:a.childNodes[1].textContent})}):"drop-content"==a.parentNode.parentNode.parentNode.className&&b+1==nonwExpandableFo.length&&a.addEventListener("click",function(){dataLayer.push({event:"eventTracker",eventCat:"user login",eventAct:"logout",eventLbl:"global nav | unified"})})});
var expandable=document.querySelectorAll(".orm-ff-NavigationSubnav-toggleControls a, .orm-ff-NavigationView-toggleControls a");expandable.forEach(function(a){a.addEventListener("click",function(){dataLayer.push({event:"eventTracker",eventCat:"global nav",eventAct:"navigation",eventLbl:a.parentNode.parentNode.parentNode.querySelectorAll(".orm-Button-btnContentWrap span")[0].childNodes[1].textContent+" | "+a.textContent})})});var flyoutLinks=document.querySelectorAll(".flyout a");
flyoutLinks.forEach(function(a){a.addEventListener("click",function(){dataLayer.push({event:"eventTracker",eventCat:"global nav",eventAct:"navigation",eventLbl:a.closest("li.flyout-parent").getElementsByTagName("a")[0].textContent+" | "+a.textContent})})});</script></body></html>